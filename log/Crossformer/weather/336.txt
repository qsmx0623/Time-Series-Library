Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_96      Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_96_Crossformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5249556
	speed: 0.1462s/iter; left time: 1650.9931s
	iters: 200, epoch: 1 | loss: 0.4492672
	speed: 0.1277s/iter; left time: 1429.3984s
	iters: 300, epoch: 1 | loss: 0.4884391
	speed: 0.1369s/iter; left time: 1518.8843s
	iters: 400, epoch: 1 | loss: 0.5304961
	speed: 0.1388s/iter; left time: 1525.2608s
	iters: 500, epoch: 1 | loss: 1.2576108
	speed: 0.1385s/iter; left time: 1508.2760s
	iters: 600, epoch: 1 | loss: 0.5304559
	speed: 0.1394s/iter; left time: 1504.0999s
	iters: 700, epoch: 1 | loss: 0.4963058
	speed: 0.1408s/iter; left time: 1505.7105s
	iters: 800, epoch: 1 | loss: 0.3816151
	speed: 0.1409s/iter; left time: 1492.5169s
	iters: 900, epoch: 1 | loss: 0.4198599
	speed: 0.1356s/iter; left time: 1422.6098s
	iters: 1000, epoch: 1 | loss: 0.4614512
	speed: 0.1371s/iter; left time: 1424.7310s
	iters: 1100, epoch: 1 | loss: 0.4054835
	speed: 0.1361s/iter; left time: 1400.1305s
Epoch: 1 cost time: 157.05130887031555
Epoch: 1, Steps: 1139 | Train Loss: 0.7325916 Vali Loss: 0.5139052 Test Loss: 0.1848916
Validation loss decreased (inf --> 0.513905).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3966438
	speed: 0.6018s/iter; left time: 6109.5905s
	iters: 200, epoch: 2 | loss: 0.4149920
	speed: 0.1408s/iter; left time: 1415.5683s
	iters: 300, epoch: 2 | loss: 0.4843145
	speed: 0.1428s/iter; left time: 1421.5921s
	iters: 400, epoch: 2 | loss: 0.5308589
	speed: 0.1326s/iter; left time: 1306.4673s
	iters: 500, epoch: 2 | loss: 0.4620078
	speed: 0.1371s/iter; left time: 1337.4269s
	iters: 600, epoch: 2 | loss: 0.4384304
	speed: 0.1342s/iter; left time: 1294.8699s
	iters: 700, epoch: 2 | loss: 0.5548652
	speed: 0.1390s/iter; left time: 1327.5584s
	iters: 800, epoch: 2 | loss: 0.4527793
	speed: 0.1421s/iter; left time: 1342.7812s
	iters: 900, epoch: 2 | loss: 0.4174398
	speed: 0.1379s/iter; left time: 1289.9120s
	iters: 1000, epoch: 2 | loss: 0.4444239
	speed: 0.1400s/iter; left time: 1295.3118s
	iters: 1100, epoch: 2 | loss: 0.4521390
	speed: 0.1432s/iter; left time: 1310.2130s
Epoch: 2 cost time: 158.68578267097473
Epoch: 2, Steps: 1139 | Train Loss: 0.5690269 Vali Loss: 0.5067199 Test Loss: 0.1878021
Validation loss decreased (0.513905 --> 0.506720).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 1.4148810
	speed: 0.6219s/iter; left time: 5605.4269s
	iters: 200, epoch: 3 | loss: 1.2526212
	speed: 0.1401s/iter; left time: 1248.4353s
	iters: 300, epoch: 3 | loss: 0.6899820
	speed: 0.1404s/iter; left time: 1237.6216s
	iters: 400, epoch: 3 | loss: 0.5420477
	speed: 0.1363s/iter; left time: 1187.6738s
	iters: 500, epoch: 3 | loss: 0.3906289
	speed: 0.1379s/iter; left time: 1187.9188s
	iters: 600, epoch: 3 | loss: 0.4977535
	speed: 0.1427s/iter; left time: 1214.4571s
	iters: 700, epoch: 3 | loss: 0.4624501
	speed: 0.1409s/iter; left time: 1185.4776s
	iters: 800, epoch: 3 | loss: 0.7470855
	speed: 0.1406s/iter; left time: 1168.7592s
	iters: 900, epoch: 3 | loss: 0.5311285
	speed: 0.1392s/iter; left time: 1143.5651s
	iters: 1000, epoch: 3 | loss: 0.5225210
	speed: 0.1403s/iter; left time: 1138.1310s
	iters: 1100, epoch: 3 | loss: 1.4710960
	speed: 0.1400s/iter; left time: 1121.8089s
Epoch: 3 cost time: 159.60168981552124
Epoch: 3, Steps: 1139 | Train Loss: 0.5513648 Vali Loss: 0.5108811 Test Loss: 0.1871256
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4123481
	speed: 0.6049s/iter; left time: 4762.7745s
	iters: 200, epoch: 4 | loss: 0.5603347
	speed: 0.1400s/iter; left time: 1088.5993s
	iters: 300, epoch: 4 | loss: 0.3863985
	speed: 0.1404s/iter; left time: 1077.2815s
	iters: 400, epoch: 4 | loss: 0.4592548
	speed: 0.1376s/iter; left time: 1042.2178s
	iters: 500, epoch: 4 | loss: 0.4271029
	speed: 0.1390s/iter; left time: 1038.9883s
	iters: 600, epoch: 4 | loss: 0.4458053
	speed: 0.1402s/iter; left time: 1033.7217s
	iters: 700, epoch: 4 | loss: 0.6817321
	speed: 0.1392s/iter; left time: 1012.7693s
	iters: 800, epoch: 4 | loss: 0.5425098
	speed: 0.1409s/iter; left time: 1010.8782s
	iters: 900, epoch: 4 | loss: 0.3844355
	speed: 0.1392s/iter; left time: 984.3504s
	iters: 1000, epoch: 4 | loss: 0.4121821
	speed: 0.1405s/iter; left time: 979.9732s
	iters: 1100, epoch: 4 | loss: 0.4007955
	speed: 0.1397s/iter; left time: 960.0342s
Epoch: 4 cost time: 159.48121428489685
Epoch: 4, Steps: 1139 | Train Loss: 0.5455761 Vali Loss: 0.5052437 Test Loss: 0.1809618
Validation loss decreased (0.506720 --> 0.505244).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5326619
	speed: 0.6172s/iter; left time: 4157.0297s
	iters: 200, epoch: 5 | loss: 0.3839214
	speed: 0.1379s/iter; left time: 914.9042s
	iters: 300, epoch: 5 | loss: 0.5527363
	speed: 0.1402s/iter; left time: 916.2081s
	iters: 400, epoch: 5 | loss: 0.4658760
	speed: 0.1368s/iter; left time: 880.0409s
	iters: 500, epoch: 5 | loss: 0.3979306
	speed: 0.1427s/iter; left time: 903.8174s
	iters: 600, epoch: 5 | loss: 0.4468327
	speed: 0.1401s/iter; left time: 873.6648s
	iters: 700, epoch: 5 | loss: 0.3797933
	speed: 0.1391s/iter; left time: 853.2783s
	iters: 800, epoch: 5 | loss: 0.4274775
	speed: 0.1397s/iter; left time: 842.8988s
	iters: 900, epoch: 5 | loss: 0.4586133
	speed: 0.1400s/iter; left time: 831.0200s
	iters: 1000, epoch: 5 | loss: 0.4686866
	speed: 0.1388s/iter; left time: 809.7885s
	iters: 1100, epoch: 5 | loss: 0.4790425
	speed: 0.1455s/iter; left time: 834.2068s
Epoch: 5 cost time: 160.25809979438782
Epoch: 5, Steps: 1139 | Train Loss: 0.5423564 Vali Loss: 0.5050653 Test Loss: 0.1799062
Validation loss decreased (0.505244 --> 0.505065).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4703120
	speed: 0.6174s/iter; left time: 3455.2490s
	iters: 200, epoch: 6 | loss: 0.4497430
	speed: 0.1405s/iter; left time: 772.2697s
	iters: 300, epoch: 6 | loss: 0.5795683
	speed: 0.1411s/iter; left time: 761.4006s
	iters: 400, epoch: 6 | loss: 0.5551160
	speed: 0.1122s/iter; left time: 594.1921s
	iters: 500, epoch: 6 | loss: 0.4151228
	speed: 0.1141s/iter; left time: 592.6971s
	iters: 600, epoch: 6 | loss: 0.4470645
	speed: 0.1126s/iter; left time: 573.6092s
	iters: 700, epoch: 6 | loss: 0.4705159
	speed: 0.1142s/iter; left time: 570.4570s
	iters: 800, epoch: 6 | loss: 0.7937631
	speed: 0.1140s/iter; left time: 558.2638s
	iters: 900, epoch: 6 | loss: 0.3710349
	speed: 0.1133s/iter; left time: 543.4792s
	iters: 1000, epoch: 6 | loss: 0.4406932
	speed: 0.1163s/iter; left time: 546.3294s
	iters: 1100, epoch: 6 | loss: 0.3921015
	speed: 0.1128s/iter; left time: 518.6539s
Epoch: 6 cost time: 137.85898756980896
Epoch: 6, Steps: 1139 | Train Loss: 0.5394461 Vali Loss: 0.5016774 Test Loss: 0.1773216
Validation loss decreased (0.505065 --> 0.501677).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.6280517
	speed: 0.5452s/iter; left time: 2429.9401s
	iters: 200, epoch: 7 | loss: 0.3481764
	speed: 0.1153s/iter; left time: 502.2916s
	iters: 300, epoch: 7 | loss: 0.3796712
	speed: 0.1259s/iter; left time: 535.7940s
	iters: 400, epoch: 7 | loss: 0.5443529
	speed: 0.1393s/iter; left time: 578.8918s
	iters: 500, epoch: 7 | loss: 0.3704668
	speed: 0.1390s/iter; left time: 563.7863s
	iters: 600, epoch: 7 | loss: 0.4136599
	speed: 0.1424s/iter; left time: 563.5410s
	iters: 700, epoch: 7 | loss: 0.4914712
	speed: 0.1399s/iter; left time: 539.6073s
	iters: 800, epoch: 7 | loss: 0.5447606
	speed: 0.1385s/iter; left time: 520.2078s
	iters: 900, epoch: 7 | loss: 0.5005764
	speed: 0.1389s/iter; left time: 508.0323s
	iters: 1000, epoch: 7 | loss: 0.3597410
	speed: 0.1402s/iter; left time: 498.7568s
	iters: 1100, epoch: 7 | loss: 0.4017470
	speed: 0.1418s/iter; left time: 490.1072s
Epoch: 7 cost time: 153.18998503684998
Epoch: 7, Steps: 1139 | Train Loss: 0.5383233 Vali Loss: 0.5065240 Test Loss: 0.1807095
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4028324
	speed: 0.6234s/iter; left time: 2068.4762s
	iters: 200, epoch: 8 | loss: 1.3745522
	speed: 0.1417s/iter; left time: 456.0099s
	iters: 300, epoch: 8 | loss: 1.3362151
	speed: 0.1406s/iter; left time: 438.4772s
	iters: 400, epoch: 8 | loss: 0.5029612
	speed: 0.1403s/iter; left time: 423.3327s
	iters: 500, epoch: 8 | loss: 0.4477615
	speed: 0.1390s/iter; left time: 405.4600s
	iters: 600, epoch: 8 | loss: 0.3660971
	speed: 0.1422s/iter; left time: 400.8484s
	iters: 700, epoch: 8 | loss: 0.4165741
	speed: 0.1385s/iter; left time: 376.3214s
	iters: 800, epoch: 8 | loss: 0.3813322
	speed: 0.1459s/iter; left time: 381.9387s
	iters: 900, epoch: 8 | loss: 0.5870721
	speed: 0.1431s/iter; left time: 360.3241s
	iters: 1000, epoch: 8 | loss: 0.4767211
	speed: 0.1405s/iter; left time: 339.6909s
	iters: 1100, epoch: 8 | loss: 0.3448834
	speed: 0.1430s/iter; left time: 331.4280s
Epoch: 8 cost time: 161.40555047988892
Epoch: 8, Steps: 1139 | Train Loss: 0.5373183 Vali Loss: 0.5017665 Test Loss: 0.1762835
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.7382225
	speed: 0.6711s/iter; left time: 1462.2843s
	iters: 200, epoch: 9 | loss: 0.4458009
	speed: 0.1398s/iter; left time: 290.6911s
	iters: 300, epoch: 9 | loss: 0.4574428
	speed: 0.1423s/iter; left time: 281.6730s
	iters: 400, epoch: 9 | loss: 0.3372790
	speed: 0.1388s/iter; left time: 260.8914s
	iters: 500, epoch: 9 | loss: 0.4328982
	speed: 0.1431s/iter; left time: 254.5954s
	iters: 600, epoch: 9 | loss: 0.4862641
	speed: 0.1411s/iter; left time: 236.8505s
	iters: 700, epoch: 9 | loss: 0.5526548
	speed: 0.1457s/iter; left time: 229.9919s
	iters: 800, epoch: 9 | loss: 0.4953309
	speed: 0.1394s/iter; left time: 206.1599s
	iters: 900, epoch: 9 | loss: 0.4150363
	speed: 0.1416s/iter; left time: 195.3208s
	iters: 1000, epoch: 9 | loss: 0.4740272
	speed: 0.1392s/iter; left time: 178.0541s
	iters: 1100, epoch: 9 | loss: 0.4884888
	speed: 0.1398s/iter; left time: 164.8498s
Epoch: 9 cost time: 160.8251769542694
Epoch: 9, Steps: 1139 | Train Loss: 0.5364158 Vali Loss: 0.5021419 Test Loss: 0.1767983
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6006985
	speed: 0.6548s/iter; left time: 680.9597s
	iters: 200, epoch: 10 | loss: 0.4546683
	speed: 0.1394s/iter; left time: 131.0078s
	iters: 300, epoch: 10 | loss: 0.5323524
	speed: 0.1385s/iter; left time: 116.3655s
	iters: 400, epoch: 10 | loss: 0.5651498
	speed: 0.1409s/iter; left time: 104.2966s
	iters: 500, epoch: 10 | loss: 0.4228815
	speed: 0.1406s/iter; left time: 89.9741s
	iters: 600, epoch: 10 | loss: 0.6505944
	speed: 0.1370s/iter; left time: 73.9983s
	iters: 700, epoch: 10 | loss: 0.4698582
	speed: 0.1477s/iter; left time: 64.9822s
	iters: 800, epoch: 10 | loss: 0.7403381
	speed: 0.1413s/iter; left time: 48.0367s
	iters: 900, epoch: 10 | loss: 1.1795019
	speed: 0.1366s/iter; left time: 32.7894s
	iters: 1000, epoch: 10 | loss: 0.5135534
	speed: 0.1441s/iter; left time: 20.1751s
	iters: 1100, epoch: 10 | loss: 0.5230072
	speed: 0.1428s/iter; left time: 5.7102s
Epoch: 10 cost time: 160.23811197280884
Epoch: 10, Steps: 1139 | Train Loss: 0.5349935 Vali Loss: 0.5013442 Test Loss: 0.1761964
Validation loss decreased (0.501677 --> 0.501344).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_96_Crossformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1761963963508606, mae:0.24974919855594635
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_192     Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_192_Crossformer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5579882
	speed: 0.1911s/iter; left time: 2152.4203s
	iters: 200, epoch: 1 | loss: 1.4445977
	speed: 0.1690s/iter; left time: 1885.8942s
	iters: 300, epoch: 1 | loss: 0.6497297
	speed: 0.1861s/iter; left time: 2058.3860s
	iters: 400, epoch: 1 | loss: 0.4984452
	speed: 0.1809s/iter; left time: 1983.1220s
	iters: 500, epoch: 1 | loss: 1.0994194
	speed: 0.1744s/iter; left time: 1894.0914s
	iters: 600, epoch: 1 | loss: 0.5394530
	speed: 0.1843s/iter; left time: 1983.3689s
	iters: 700, epoch: 1 | loss: 0.6500086
	speed: 0.1731s/iter; left time: 1845.7295s
	iters: 800, epoch: 1 | loss: 0.4624507
	speed: 0.1834s/iter; left time: 1937.2613s
	iters: 900, epoch: 1 | loss: 0.5518628
	speed: 0.1868s/iter; left time: 1954.1437s
	iters: 1000, epoch: 1 | loss: 0.5259432
	speed: 0.1728s/iter; left time: 1790.5571s
	iters: 1100, epoch: 1 | loss: 0.5513728
	speed: 0.1861s/iter; left time: 1909.1994s
Epoch: 1 cost time: 205.56930232048035
Epoch: 1, Steps: 1136 | Train Loss: 0.7872181 Vali Loss: 0.6220937 Test Loss: 0.2637824
Validation loss decreased (inf --> 0.622094).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5184537
	speed: 0.7514s/iter; left time: 7608.0064s
	iters: 200, epoch: 2 | loss: 0.6818286
	speed: 0.1798s/iter; left time: 1802.2641s
	iters: 300, epoch: 2 | loss: 0.4744347
	speed: 0.1757s/iter; left time: 1743.9465s
	iters: 400, epoch: 2 | loss: 0.5560551
	speed: 0.1856s/iter; left time: 1823.4588s
	iters: 500, epoch: 2 | loss: 0.5046134
	speed: 0.1813s/iter; left time: 1763.2226s
	iters: 600, epoch: 2 | loss: 0.7341483
	speed: 0.1759s/iter; left time: 1692.8297s
	iters: 700, epoch: 2 | loss: 0.4794949
	speed: 0.1584s/iter; left time: 1508.5924s
	iters: 800, epoch: 2 | loss: 1.1065425
	speed: 0.1430s/iter; left time: 1347.3561s
	iters: 900, epoch: 2 | loss: 0.5989307
	speed: 0.1452s/iter; left time: 1354.1436s
	iters: 1000, epoch: 2 | loss: 0.4872608
	speed: 0.1441s/iter; left time: 1329.3716s
	iters: 1100, epoch: 2 | loss: 0.6319270
	speed: 0.1447s/iter; left time: 1320.0007s
Epoch: 2 cost time: 187.17768597602844
Epoch: 2, Steps: 1136 | Train Loss: 0.6269983 Vali Loss: 0.5796321 Test Loss: 0.2306035
Validation loss decreased (0.622094 --> 0.579632).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5308193
	speed: 0.6475s/iter; left time: 5820.2430s
	iters: 200, epoch: 3 | loss: 0.4556985
	speed: 0.1415s/iter; left time: 1258.0123s
	iters: 300, epoch: 3 | loss: 0.4664797
	speed: 0.1464s/iter; left time: 1286.8384s
	iters: 400, epoch: 3 | loss: 0.8761596
	speed: 0.1815s/iter; left time: 1577.1780s
	iters: 500, epoch: 3 | loss: 0.6319095
	speed: 0.1791s/iter; left time: 1538.0828s
	iters: 600, epoch: 3 | loss: 1.0639364
	speed: 0.1783s/iter; left time: 1513.4017s
	iters: 700, epoch: 3 | loss: 0.5491004
	speed: 0.1812s/iter; left time: 1519.9746s
	iters: 800, epoch: 3 | loss: 0.5501027
	speed: 0.1756s/iter; left time: 1455.6791s
	iters: 900, epoch: 3 | loss: 0.5306597
	speed: 0.1847s/iter; left time: 1512.8105s
	iters: 1000, epoch: 3 | loss: 0.4851313
	speed: 0.1806s/iter; left time: 1460.5200s
	iters: 1100, epoch: 3 | loss: 0.4831004
	speed: 0.1774s/iter; left time: 1417.4703s
Epoch: 3 cost time: 193.62839269638062
Epoch: 3, Steps: 1136 | Train Loss: 0.6098624 Vali Loss: 0.5733458 Test Loss: 0.2232670
Validation loss decreased (0.579632 --> 0.573346).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6338432
	speed: 0.7692s/iter; left time: 6040.1764s
	iters: 200, epoch: 4 | loss: 1.0036043
	speed: 0.1715s/iter; left time: 1329.4014s
	iters: 300, epoch: 4 | loss: 0.4262386
	speed: 0.1822s/iter; left time: 1394.1110s
	iters: 400, epoch: 4 | loss: 0.5147439
	speed: 0.1750s/iter; left time: 1322.0599s
	iters: 500, epoch: 4 | loss: 0.5558354
	speed: 0.1804s/iter; left time: 1344.7586s
	iters: 600, epoch: 4 | loss: 0.5382890
	speed: 0.1760s/iter; left time: 1294.1114s
	iters: 700, epoch: 4 | loss: 0.5553369
	speed: 0.1853s/iter; left time: 1343.8924s
	iters: 800, epoch: 4 | loss: 0.5415762
	speed: 0.1732s/iter; left time: 1238.8937s
	iters: 900, epoch: 4 | loss: 0.4627515
	speed: 0.1824s/iter; left time: 1286.6585s
	iters: 1000, epoch: 4 | loss: 0.5383440
	speed: 0.1839s/iter; left time: 1278.9801s
	iters: 1100, epoch: 4 | loss: 0.4329891
	speed: 0.1736s/iter; left time: 1189.4863s
Epoch: 4 cost time: 203.636084318161
Epoch: 4, Steps: 1136 | Train Loss: 0.6039725 Vali Loss: 0.5755113 Test Loss: 0.2191698
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4957858
	speed: 0.7347s/iter; left time: 4935.0373s
	iters: 200, epoch: 5 | loss: 0.6808332
	speed: 0.1763s/iter; left time: 1166.7754s
	iters: 300, epoch: 5 | loss: 0.7651138
	speed: 0.1808s/iter; left time: 1177.9785s
	iters: 400, epoch: 5 | loss: 0.4697309
	speed: 0.1761s/iter; left time: 1129.8735s
	iters: 500, epoch: 5 | loss: 0.5463342
	speed: 0.1766s/iter; left time: 1115.3298s
	iters: 600, epoch: 5 | loss: 0.5476297
	speed: 0.1864s/iter; left time: 1158.9732s
	iters: 700, epoch: 5 | loss: 1.0013360
	speed: 0.1739s/iter; left time: 1063.6018s
	iters: 800, epoch: 5 | loss: 0.5089433
	speed: 0.1819s/iter; left time: 1094.7403s
	iters: 900, epoch: 5 | loss: 0.4802917
	speed: 0.1773s/iter; left time: 1048.9421s
	iters: 1000, epoch: 5 | loss: 1.3125689
	speed: 0.1810s/iter; left time: 1052.7782s
	iters: 1100, epoch: 5 | loss: 0.5009311
	speed: 0.1862s/iter; left time: 1064.5367s
Epoch: 5 cost time: 204.69241404533386
Epoch: 5, Steps: 1136 | Train Loss: 0.6004596 Vali Loss: 0.5736748 Test Loss: 0.2207028
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5062870
	speed: 0.7503s/iter; left time: 4187.2099s
	iters: 200, epoch: 6 | loss: 0.7950345
	speed: 0.1852s/iter; left time: 1015.2979s
	iters: 300, epoch: 6 | loss: 0.4735228
	speed: 0.1836s/iter; left time: 987.9573s
	iters: 400, epoch: 6 | loss: 0.9601195
	speed: 0.1778s/iter; left time: 938.9245s
	iters: 500, epoch: 6 | loss: 0.5569115
	speed: 0.1861s/iter; left time: 964.2095s
	iters: 600, epoch: 6 | loss: 1.0161613
	speed: 0.1819s/iter; left time: 924.3599s
	iters: 700, epoch: 6 | loss: 0.3868152
	speed: 0.1842s/iter; left time: 917.7369s
	iters: 800, epoch: 6 | loss: 0.7295584
	speed: 0.1844s/iter; left time: 900.1629s
	iters: 900, epoch: 6 | loss: 0.9329945
	speed: 0.1800s/iter; left time: 860.7037s
	iters: 1000, epoch: 6 | loss: 0.9642683
	speed: 0.1940s/iter; left time: 908.2060s
	iters: 1100, epoch: 6 | loss: 0.3937901
	speed: 0.1792s/iter; left time: 820.7815s
Epoch: 6 cost time: 208.05737900733948
Epoch: 6, Steps: 1136 | Train Loss: 0.5978476 Vali Loss: 0.5765127 Test Loss: 0.2270439
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.6263826
	speed: 0.8606s/iter; left time: 3825.2461s
	iters: 200, epoch: 7 | loss: 0.4770449
	speed: 0.1849s/iter; left time: 803.3454s
	iters: 300, epoch: 7 | loss: 0.5443867
	speed: 0.1909s/iter; left time: 810.2902s
	iters: 400, epoch: 7 | loss: 0.5119312
	speed: 0.1903s/iter; left time: 788.6630s
	iters: 500, epoch: 7 | loss: 0.5525853
	speed: 0.1922s/iter; left time: 777.5723s
	iters: 600, epoch: 7 | loss: 1.3163241
	speed: 0.1846s/iter; left time: 728.2778s
	iters: 700, epoch: 7 | loss: 0.5737749
	speed: 0.1925s/iter; left time: 740.2151s
	iters: 800, epoch: 7 | loss: 0.5173661
	speed: 0.1914s/iter; left time: 716.8760s
	iters: 900, epoch: 7 | loss: 0.9687201
	speed: 0.1903s/iter; left time: 693.6264s
	iters: 1000, epoch: 7 | loss: 0.6083254
	speed: 0.1873s/iter; left time: 664.0218s
	iters: 1100, epoch: 7 | loss: 0.4406804
	speed: 0.1971s/iter; left time: 678.8936s
Epoch: 7 cost time: 216.06254720687866
Epoch: 7, Steps: 1136 | Train Loss: 0.5953306 Vali Loss: 0.5684380 Test Loss: 0.2208973
Validation loss decreased (0.573346 --> 0.568438).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5041411
	speed: 0.8323s/iter; left time: 2754.0496s
	iters: 200, epoch: 8 | loss: 0.6424717
	speed: 0.1536s/iter; left time: 492.9237s
	iters: 300, epoch: 8 | loss: 0.5363604
	speed: 0.1602s/iter; left time: 498.1745s
	iters: 400, epoch: 8 | loss: 0.5564206
	speed: 0.1524s/iter; left time: 458.4585s
	iters: 500, epoch: 8 | loss: 1.1131929
	speed: 0.1527s/iter; left time: 444.2702s
	iters: 600, epoch: 8 | loss: 0.4408270
	speed: 0.1596s/iter; left time: 448.4488s
	iters: 700, epoch: 8 | loss: 0.5752378
	speed: 0.1552s/iter; left time: 420.5542s
	iters: 800, epoch: 8 | loss: 0.6498132
	speed: 0.1576s/iter; left time: 411.1617s
	iters: 900, epoch: 8 | loss: 0.4502734
	speed: 0.1605s/iter; left time: 402.7950s
	iters: 1000, epoch: 8 | loss: 0.4246293
	speed: 0.1592s/iter; left time: 383.4231s
	iters: 1100, epoch: 8 | loss: 0.6130812
	speed: 0.1965s/iter; left time: 453.7410s
Epoch: 8 cost time: 183.79750084877014
Epoch: 8, Steps: 1136 | Train Loss: 0.5632253 Vali Loss: 0.5210749 Test Loss: 0.2222506
Validation loss decreased (0.568438 --> 0.521075).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4072949
	speed: 0.8855s/iter; left time: 1924.2050s
	iters: 200, epoch: 9 | loss: 0.4210798
	speed: 0.1834s/iter; left time: 380.2104s
	iters: 300, epoch: 9 | loss: 0.4271315
	speed: 0.1855s/iter; left time: 365.9752s
	iters: 400, epoch: 9 | loss: 0.8007724
	speed: 0.1933s/iter; left time: 362.0731s
	iters: 500, epoch: 9 | loss: 0.8649163
	speed: 0.1858s/iter; left time: 329.4161s
	iters: 600, epoch: 9 | loss: 0.3647885
	speed: 0.1939s/iter; left time: 324.4061s
	iters: 700, epoch: 9 | loss: 0.4240703
	speed: 0.1808s/iter; left time: 284.3601s
	iters: 800, epoch: 9 | loss: 0.3729374
	speed: 0.1945s/iter; left time: 286.4399s
	iters: 900, epoch: 9 | loss: 0.3909005
	speed: 0.1911s/iter; left time: 262.3690s
	iters: 1000, epoch: 9 | loss: 0.5340603
	speed: 0.1927s/iter; left time: 245.2554s
	iters: 1100, epoch: 9 | loss: 0.6516953
	speed: 0.1868s/iter; left time: 219.1072s
Epoch: 9 cost time: 214.8368570804596
Epoch: 9, Steps: 1136 | Train Loss: 0.5213203 Vali Loss: 0.4965597 Test Loss: 0.2190754
Validation loss decreased (0.521075 --> 0.496560).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3532115
	speed: 0.8624s/iter; left time: 894.3426s
	iters: 200, epoch: 10 | loss: 0.3941901
	speed: 0.1926s/iter; left time: 180.4623s
	iters: 300, epoch: 10 | loss: 0.3555273
	speed: 0.1804s/iter; left time: 150.9679s
	iters: 400, epoch: 10 | loss: 0.4740966
	speed: 0.1947s/iter; left time: 143.4690s
	iters: 500, epoch: 10 | loss: 0.8814895
	speed: 0.1887s/iter; left time: 120.2129s
	iters: 600, epoch: 10 | loss: 0.4577258
	speed: 0.1941s/iter; left time: 104.2491s
	iters: 700, epoch: 10 | loss: 0.9688818
	speed: 0.1846s/iter; left time: 80.6574s
	iters: 800, epoch: 10 | loss: 0.9189830
	speed: 0.1863s/iter; left time: 62.7868s
	iters: 900, epoch: 10 | loss: 0.5026979
	speed: 0.1950s/iter; left time: 46.2119s
	iters: 1000, epoch: 10 | loss: 0.5414912
	speed: 0.1852s/iter; left time: 25.3669s
	iters: 1100, epoch: 10 | loss: 0.8621677
	speed: 0.1954s/iter; left time: 7.2290s
Epoch: 10 cost time: 216.22882318496704
Epoch: 10, Steps: 1136 | Train Loss: 0.5068384 Vali Loss: 0.4912119 Test Loss: 0.2190042
Validation loss decreased (0.496560 --> 0.491212).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_192_Crossformer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.21900412440299988, mae:0.28733664751052856
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_336     Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_336_Crossformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 1.3019040
	speed: 0.2531s/iter; left time: 2837.9515s
	iters: 200, epoch: 1 | loss: 0.7061942
	speed: 0.2520s/iter; left time: 2800.1107s
	iters: 300, epoch: 1 | loss: 0.6612904
	speed: 0.2521s/iter; left time: 2776.0671s
	iters: 400, epoch: 1 | loss: 0.6617487
	speed: 0.2420s/iter; left time: 2640.8425s
	iters: 500, epoch: 1 | loss: 0.6588202
	speed: 0.2432s/iter; left time: 2629.0816s
	iters: 600, epoch: 1 | loss: 0.5416347
	speed: 0.2475s/iter; left time: 2650.5211s
	iters: 700, epoch: 1 | loss: 0.5297464
	speed: 0.2458s/iter; left time: 2608.2151s
	iters: 800, epoch: 1 | loss: 0.5858707
	speed: 0.2453s/iter; left time: 2577.8251s
	iters: 900, epoch: 1 | loss: 0.8290212
	speed: 0.2518s/iter; left time: 2621.2689s
	iters: 1000, epoch: 1 | loss: 0.7358040
	speed: 0.2531s/iter; left time: 2610.0878s
	iters: 1100, epoch: 1 | loss: 0.8675367
	speed: 0.2459s/iter; left time: 2511.1319s
Epoch: 1 cost time: 281.1505391597748
Epoch: 1, Steps: 1131 | Train Loss: 0.8256061 Vali Loss: 0.6508920 Test Loss: 0.2828149
Validation loss decreased (inf --> 0.650892).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6830134
	speed: 1.0353s/iter; left time: 10436.3162s
	iters: 200, epoch: 2 | loss: 0.8214867
	speed: 0.2423s/iter; left time: 2417.9914s
	iters: 300, epoch: 2 | loss: 0.6433772
	speed: 0.2503s/iter; left time: 2473.1347s
	iters: 400, epoch: 2 | loss: 0.5874709
	speed: 0.2528s/iter; left time: 2472.6095s
	iters: 500, epoch: 2 | loss: 0.9469371
	speed: 0.2459s/iter; left time: 2380.2249s
	iters: 600, epoch: 2 | loss: 0.6079429
	speed: 0.2428s/iter; left time: 2325.7529s
	iters: 700, epoch: 2 | loss: 0.5411924
	speed: 0.2461s/iter; left time: 2332.5973s
	iters: 800, epoch: 2 | loss: 0.5804582
	speed: 0.2480s/iter; left time: 2326.5466s
	iters: 900, epoch: 2 | loss: 0.5418796
	speed: 0.2514s/iter; left time: 2333.2527s
	iters: 1000, epoch: 2 | loss: 0.6179196
	speed: 0.2478s/iter; left time: 2274.6737s
	iters: 1100, epoch: 2 | loss: 0.5673160
	speed: 0.2499s/iter; left time: 2269.2866s
Epoch: 2 cost time: 279.87943959236145
Epoch: 2, Steps: 1131 | Train Loss: 0.6759127 Vali Loss: 0.6628601 Test Loss: 0.2849028
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7161577
	speed: 0.9249s/iter; left time: 8277.3365s
	iters: 200, epoch: 3 | loss: 0.6090171
	speed: 0.2023s/iter; left time: 1789.8331s
	iters: 300, epoch: 3 | loss: 0.6282392
	speed: 0.2015s/iter; left time: 1762.6745s
	iters: 400, epoch: 3 | loss: 0.6292208
	speed: 0.2003s/iter; left time: 1732.4525s
	iters: 500, epoch: 3 | loss: 0.8706167
	speed: 0.2053s/iter; left time: 1755.0050s
	iters: 600, epoch: 3 | loss: 0.6536399
	speed: 0.2052s/iter; left time: 1733.4065s
	iters: 700, epoch: 3 | loss: 0.5178990
	speed: 0.2403s/iter; left time: 2006.3607s
	iters: 800, epoch: 3 | loss: 0.5318811
	speed: 0.2493s/iter; left time: 2056.1598s
	iters: 900, epoch: 3 | loss: 0.4593661
	speed: 0.2390s/iter; left time: 1947.3800s
	iters: 1000, epoch: 3 | loss: 0.5192893
	speed: 0.2447s/iter; left time: 1969.4196s
	iters: 1100, epoch: 3 | loss: 0.8210509
	speed: 0.2486s/iter; left time: 1975.9102s
Epoch: 3 cost time: 251.5066683292389
Epoch: 3, Steps: 1131 | Train Loss: 0.6601903 Vali Loss: 0.6601586 Test Loss: 0.2848318
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5462908
	speed: 1.0544s/iter; left time: 8243.5677s
	iters: 200, epoch: 4 | loss: 0.5269028
	speed: 0.2456s/iter; left time: 1895.8793s
	iters: 300, epoch: 4 | loss: 0.7750369
	speed: 0.2496s/iter; left time: 1901.1651s
	iters: 400, epoch: 4 | loss: 0.9042271
	speed: 0.2559s/iter; left time: 1924.0529s
	iters: 500, epoch: 4 | loss: 0.5332246
	speed: 0.2512s/iter; left time: 1863.5524s
	iters: 600, epoch: 4 | loss: 0.5758203
	speed: 0.2457s/iter; left time: 1798.0715s
	iters: 700, epoch: 4 | loss: 0.6910208
	speed: 0.2445s/iter; left time: 1764.9768s
	iters: 800, epoch: 4 | loss: 0.7836605
	speed: 0.2467s/iter; left time: 1755.9786s
	iters: 900, epoch: 4 | loss: 0.6381242
	speed: 0.2524s/iter; left time: 1771.5133s
	iters: 1000, epoch: 4 | loss: 0.5572375
	speed: 0.2489s/iter; left time: 1722.1648s
	iters: 1100, epoch: 4 | loss: 0.5244455
	speed: 0.2464s/iter; left time: 1680.2117s
Epoch: 4 cost time: 281.20007610321045
Epoch: 4, Steps: 1131 | Train Loss: 0.6545194 Vali Loss: 0.6548358 Test Loss: 0.2842383
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6170900
	speed: 1.0387s/iter; left time: 6946.0519s
	iters: 200, epoch: 5 | loss: 0.5120187
	speed: 0.2438s/iter; left time: 1605.8741s
	iters: 300, epoch: 5 | loss: 0.5838627
	speed: 0.2486s/iter; left time: 1612.7803s
	iters: 400, epoch: 5 | loss: 0.5364624
	speed: 0.2445s/iter; left time: 1561.5194s
	iters: 500, epoch: 5 | loss: 0.5680405
	speed: 0.2484s/iter; left time: 1561.5711s
	iters: 600, epoch: 5 | loss: 0.5363073
	speed: 0.2469s/iter; left time: 1527.7390s
	iters: 700, epoch: 5 | loss: 0.4928597
	speed: 0.2452s/iter; left time: 1492.6846s
	iters: 800, epoch: 5 | loss: 0.4850588
	speed: 0.2498s/iter; left time: 1495.3045s
	iters: 900, epoch: 5 | loss: 0.5406226
	speed: 0.2490s/iter; left time: 1465.6037s
	iters: 1000, epoch: 5 | loss: 0.5830726
	speed: 0.2554s/iter; left time: 1477.7885s
	iters: 1100, epoch: 5 | loss: 1.1062824
	speed: 0.2480s/iter; left time: 1410.3346s
Epoch: 5 cost time: 280.3421769142151
Epoch: 5, Steps: 1131 | Train Loss: 0.6493394 Vali Loss: 0.6489453 Test Loss: 0.2813581
Validation loss decreased (0.650892 --> 0.648945).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4812437
	speed: 1.0750s/iter; left time: 5972.5551s
	iters: 200, epoch: 6 | loss: 0.6422983
	speed: 0.2471s/iter; left time: 1348.0442s
	iters: 300, epoch: 6 | loss: 0.6134450
	speed: 0.2485s/iter; left time: 1330.7985s
	iters: 400, epoch: 6 | loss: 1.3369421
	speed: 0.2435s/iter; left time: 1279.7899s
	iters: 500, epoch: 6 | loss: 0.6360469
	speed: 0.2536s/iter; left time: 1307.4368s
	iters: 600, epoch: 6 | loss: 0.9234306
	speed: 0.2492s/iter; left time: 1259.9385s
	iters: 700, epoch: 6 | loss: 0.6322871
	speed: 0.2414s/iter; left time: 1196.5343s
	iters: 800, epoch: 6 | loss: 0.4800752
	speed: 0.2404s/iter; left time: 1167.1960s
	iters: 900, epoch: 6 | loss: 0.5251666
	speed: 0.2497s/iter; left time: 1187.5012s
	iters: 1000, epoch: 6 | loss: 0.5280868
	speed: 0.2456s/iter; left time: 1143.6769s
	iters: 1100, epoch: 6 | loss: 0.8003176
	speed: 0.2563s/iter; left time: 1167.7216s
Epoch: 6 cost time: 279.63550090789795
Epoch: 6, Steps: 1131 | Train Loss: 0.6467152 Vali Loss: 0.6627227 Test Loss: 0.2831059
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7298007
	speed: 1.0586s/iter; left time: 4684.0888s
	iters: 200, epoch: 7 | loss: 0.5172084
	speed: 0.2381s/iter; left time: 1029.7931s
	iters: 300, epoch: 7 | loss: 0.6647978
	speed: 0.2508s/iter; left time: 1059.4375s
	iters: 400, epoch: 7 | loss: 0.4885509
	speed: 0.2448s/iter; left time: 1009.8783s
	iters: 500, epoch: 7 | loss: 0.5242043
	speed: 0.2033s/iter; left time: 818.2143s
	iters: 600, epoch: 7 | loss: 0.8178414
	speed: 0.2020s/iter; left time: 792.7121s
	iters: 700, epoch: 7 | loss: 1.0988061
	speed: 0.2041s/iter; left time: 780.6458s
	iters: 800, epoch: 7 | loss: 0.5953991
	speed: 0.2024s/iter; left time: 753.9938s
	iters: 900, epoch: 7 | loss: 0.8503470
	speed: 0.2114s/iter; left time: 766.4006s
	iters: 1000, epoch: 7 | loss: 1.0646679
	speed: 0.2062s/iter; left time: 726.8851s
	iters: 1100, epoch: 7 | loss: 0.9130412
	speed: 0.2010s/iter; left time: 688.5391s
Epoch: 7 cost time: 247.7386989593506
Epoch: 7, Steps: 1131 | Train Loss: 0.6444640 Vali Loss: 0.6642314 Test Loss: 0.2920598
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4852204
	speed: 1.0230s/iter; left time: 3369.8836s
	iters: 200, epoch: 8 | loss: 0.8065337
	speed: 0.2436s/iter; left time: 778.0286s
	iters: 300, epoch: 8 | loss: 0.4958663
	speed: 0.2512s/iter; left time: 777.0992s
	iters: 400, epoch: 8 | loss: 0.5677038
	speed: 0.2520s/iter; left time: 754.4414s
	iters: 500, epoch: 8 | loss: 0.7718935
	speed: 0.2559s/iter; left time: 740.5107s
	iters: 600, epoch: 8 | loss: 0.5508835
	speed: 0.2455s/iter; left time: 685.9428s
	iters: 700, epoch: 8 | loss: 0.5347676
	speed: 0.2437s/iter; left time: 656.5927s
	iters: 800, epoch: 8 | loss: 0.5356463
	speed: 0.2439s/iter; left time: 632.6523s
	iters: 900, epoch: 8 | loss: 0.8139056
	speed: 0.2466s/iter; left time: 614.9554s
	iters: 1000, epoch: 8 | loss: 0.6774817
	speed: 0.2451s/iter; left time: 586.7991s
	iters: 1100, epoch: 8 | loss: 0.6128554
	speed: 0.2469s/iter; left time: 566.4810s
Epoch: 8 cost time: 279.9755437374115
Epoch: 8, Steps: 1131 | Train Loss: 0.6432493 Vali Loss: 0.6557951 Test Loss: 0.2851193
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4777613
	speed: 1.0731s/iter; left time: 2321.0271s
	iters: 200, epoch: 9 | loss: 0.7955476
	speed: 0.2485s/iter; left time: 512.6719s
	iters: 300, epoch: 9 | loss: 0.5553879
	speed: 0.2500s/iter; left time: 490.7883s
	iters: 400, epoch: 9 | loss: 0.4910138
	speed: 0.2510s/iter; left time: 467.6037s
	iters: 500, epoch: 9 | loss: 0.6269053
	speed: 0.2468s/iter; left time: 435.1863s
	iters: 600, epoch: 9 | loss: 0.5615234
	speed: 0.2458s/iter; left time: 408.6928s
	iters: 700, epoch: 9 | loss: 0.5431877
	speed: 0.2507s/iter; left time: 391.8321s
	iters: 800, epoch: 9 | loss: 0.5743741
	speed: 0.2489s/iter; left time: 364.0952s
	iters: 900, epoch: 9 | loss: 0.5730157
	speed: 0.2462s/iter; left time: 335.6072s
	iters: 1000, epoch: 9 | loss: 0.5828204
	speed: 0.2503s/iter; left time: 316.0883s
	iters: 1100, epoch: 9 | loss: 0.7987089
	speed: 0.2468s/iter; left time: 287.0092s
Epoch: 9 cost time: 280.9683094024658
Epoch: 9, Steps: 1131 | Train Loss: 0.6424236 Vali Loss: 0.6557335 Test Loss: 0.2849550
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6420007
	speed: 1.0696s/iter; left time: 1103.8059s
	iters: 200, epoch: 10 | loss: 0.7893478
	speed: 0.2419s/iter; left time: 225.4166s
	iters: 300, epoch: 10 | loss: 0.6018030
	speed: 0.2479s/iter; left time: 206.2645s
	iters: 400, epoch: 10 | loss: 0.6161138
	speed: 0.2592s/iter; left time: 189.7633s
	iters: 500, epoch: 10 | loss: 0.5114341
	speed: 0.2512s/iter; left time: 158.7507s
	iters: 600, epoch: 10 | loss: 0.5521782
	speed: 0.2461s/iter; left time: 130.9166s
	iters: 700, epoch: 10 | loss: 0.5672488
	speed: 0.2514s/iter; left time: 108.5923s
	iters: 800, epoch: 10 | loss: 0.7524991
	speed: 0.2471s/iter; left time: 82.0352s
	iters: 900, epoch: 10 | loss: 0.8039201
	speed: 0.2450s/iter; left time: 56.8352s
	iters: 1000, epoch: 10 | loss: 0.5623943
	speed: 0.2481s/iter; left time: 32.7467s
	iters: 1100, epoch: 10 | loss: 0.6206736
	speed: 0.2476s/iter; left time: 7.9237s
Epoch: 10 cost time: 280.5472643375397
Epoch: 10, Steps: 1131 | Train Loss: 0.6419713 Vali Loss: 0.6599133 Test Loss: 0.2862374
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_336_Crossformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.28135794401168823, mae:0.34477028250694275
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_720     Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_720_Crossformer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8411573
	speed: 0.4385s/iter; left time: 4863.9323s
	iters: 200, epoch: 1 | loss: 0.5948931
	speed: 0.4216s/iter; left time: 4633.9432s
	iters: 300, epoch: 1 | loss: 0.8224763
	speed: 0.4230s/iter; left time: 4606.7642s
	iters: 400, epoch: 1 | loss: 0.6944647
	speed: 0.4420s/iter; left time: 4769.2346s
	iters: 500, epoch: 1 | loss: 0.8274175
	speed: 0.4315s/iter; left time: 4613.4208s
	iters: 600, epoch: 1 | loss: 0.7417665
	speed: 0.3820s/iter; left time: 4045.4158s
	iters: 700, epoch: 1 | loss: 0.5931680
	speed: 0.3576s/iter; left time: 3751.8073s
	iters: 800, epoch: 1 | loss: 0.9460029
	speed: 0.3614s/iter; left time: 3755.5959s
	iters: 900, epoch: 1 | loss: 0.7705988
	speed: 0.3568s/iter; left time: 3671.8561s
	iters: 1000, epoch: 1 | loss: 0.5730464
	speed: 0.3566s/iter; left time: 3634.5743s
	iters: 1100, epoch: 1 | loss: 0.8174616
	speed: 0.3772s/iter; left time: 3806.3000s
Epoch: 1 cost time: 443.02981877326965
Epoch: 1, Steps: 1119 | Train Loss: 0.8435021 Vali Loss: 0.7647252 Test Loss: 0.3603397
Validation loss decreased (inf --> 0.764725).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6386267
	speed: 1.6414s/iter; left time: 16368.2646s
	iters: 200, epoch: 2 | loss: 0.9533498
	speed: 0.4386s/iter; left time: 4330.0601s
	iters: 300, epoch: 2 | loss: 0.6904981
	speed: 0.4376s/iter; left time: 4275.8584s
	iters: 400, epoch: 2 | loss: 0.6745864
	speed: 0.4321s/iter; left time: 4179.1899s
	iters: 500, epoch: 2 | loss: 0.8703093
	speed: 0.4253s/iter; left time: 4071.3976s
	iters: 600, epoch: 2 | loss: 0.7425438
	speed: 0.4343s/iter; left time: 4113.5716s
	iters: 700, epoch: 2 | loss: 0.6462782
	speed: 0.4368s/iter; left time: 4093.6433s
	iters: 800, epoch: 2 | loss: 0.8266692
	speed: 0.4309s/iter; left time: 3995.0544s
	iters: 900, epoch: 2 | loss: 0.6807762
	speed: 0.4261s/iter; left time: 3908.5825s
	iters: 1000, epoch: 2 | loss: 1.0118413
	speed: 0.4280s/iter; left time: 3882.3701s
	iters: 1100, epoch: 2 | loss: 0.6863405
	speed: 0.4336s/iter; left time: 3890.2168s
Epoch: 2 cost time: 483.99049711227417
Epoch: 2, Steps: 1119 | Train Loss: 0.7220533 Vali Loss: 0.7563876 Test Loss: 0.3641155
Validation loss decreased (0.764725 --> 0.756388).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6444043
	speed: 1.6854s/iter; left time: 14920.7271s
	iters: 200, epoch: 3 | loss: 0.7283071
	speed: 0.4302s/iter; left time: 3765.3158s
	iters: 300, epoch: 3 | loss: 0.8481938
	speed: 0.4445s/iter; left time: 3846.6829s
	iters: 400, epoch: 3 | loss: 0.7007793
	speed: 0.4379s/iter; left time: 3745.0862s
	iters: 500, epoch: 3 | loss: 0.6402241
	speed: 0.4308s/iter; left time: 3641.4970s
	iters: 600, epoch: 3 | loss: 0.7307367
	speed: 0.4302s/iter; left time: 3593.1602s
	iters: 700, epoch: 3 | loss: 0.6709129
	speed: 0.4419s/iter; left time: 3646.8206s
	iters: 800, epoch: 3 | loss: 0.7721431
	speed: 0.4308s/iter; left time: 3512.6328s
	iters: 900, epoch: 3 | loss: 0.6926236
	speed: 0.4269s/iter; left time: 3438.2277s
	iters: 1000, epoch: 3 | loss: 0.6330263
	speed: 0.4398s/iter; left time: 3497.6063s
	iters: 1100, epoch: 3 | loss: 0.6522909
	speed: 0.4359s/iter; left time: 3423.2775s
Epoch: 3 cost time: 486.88925337791443
Epoch: 3, Steps: 1119 | Train Loss: 0.7081078 Vali Loss: 0.7757576 Test Loss: 0.3590335
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6248938
	speed: 1.6708s/iter; left time: 12922.0808s
	iters: 200, epoch: 4 | loss: 0.6986769
	speed: 0.4394s/iter; left time: 3354.7278s
	iters: 300, epoch: 4 | loss: 0.8370391
	speed: 0.3817s/iter; left time: 2875.4424s
	iters: 400, epoch: 4 | loss: 0.8322573
	speed: 0.3502s/iter; left time: 2603.4839s
	iters: 500, epoch: 4 | loss: 0.5519955
	speed: 0.3531s/iter; left time: 2589.4137s
	iters: 600, epoch: 4 | loss: 0.6017048
	speed: 0.3653s/iter; left time: 2642.4957s
	iters: 700, epoch: 4 | loss: 0.7416003
	speed: 0.3554s/iter; left time: 2535.3068s
	iters: 800, epoch: 4 | loss: 0.7813324
	speed: 0.3542s/iter; left time: 2491.6968s
	iters: 900, epoch: 4 | loss: 0.6912355
	speed: 0.4239s/iter; left time: 2939.4533s
	iters: 1000, epoch: 4 | loss: 0.6376216
	speed: 0.4315s/iter; left time: 2948.9392s
	iters: 1100, epoch: 4 | loss: 0.6021333
	speed: 0.4274s/iter; left time: 2877.9917s
Epoch: 4 cost time: 439.74235105514526
Epoch: 4, Steps: 1119 | Train Loss: 0.7019490 Vali Loss: 0.7614527 Test Loss: 0.3622029
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.9324217
	speed: 1.6355s/iter; left time: 10818.9091s
	iters: 200, epoch: 5 | loss: 0.7081327
	speed: 0.4258s/iter; left time: 2773.8044s
	iters: 300, epoch: 5 | loss: 0.5791865
	speed: 0.4389s/iter; left time: 2815.7569s
	iters: 400, epoch: 5 | loss: 0.7703345
	speed: 0.4228s/iter; left time: 2669.8569s
	iters: 500, epoch: 5 | loss: 0.6833744
	speed: 0.4339s/iter; left time: 2696.5213s
	iters: 600, epoch: 5 | loss: 0.7050698
	speed: 0.4367s/iter; left time: 2670.3858s
	iters: 700, epoch: 5 | loss: 0.6481962
	speed: 0.4241s/iter; left time: 2551.1819s
	iters: 800, epoch: 5 | loss: 0.6093582
	speed: 0.4279s/iter; left time: 2531.0370s
	iters: 900, epoch: 5 | loss: 0.6742365
	speed: 0.4257s/iter; left time: 2475.6707s
	iters: 1000, epoch: 5 | loss: 0.6099572
	speed: 0.4288s/iter; left time: 2450.5848s
	iters: 1100, epoch: 5 | loss: 0.7505097
	speed: 0.4316s/iter; left time: 2423.2083s
Epoch: 5 cost time: 480.89384627342224
Epoch: 5, Steps: 1119 | Train Loss: 0.6985761 Vali Loss: 0.7682831 Test Loss: 0.3601701
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.8266591
	speed: 1.6753s/iter; left time: 9207.2880s
	iters: 200, epoch: 6 | loss: 0.5781742
	speed: 0.4310s/iter; left time: 2325.6022s
	iters: 300, epoch: 6 | loss: 0.5915813
	speed: 0.4369s/iter; left time: 2313.7867s
	iters: 400, epoch: 6 | loss: 0.6552970
	speed: 0.4317s/iter; left time: 2243.2524s
	iters: 500, epoch: 6 | loss: 0.7505726
	speed: 0.4394s/iter; left time: 2239.0790s
	iters: 600, epoch: 6 | loss: 0.6053270
	speed: 0.4264s/iter; left time: 2130.2107s
	iters: 700, epoch: 6 | loss: 0.5752294
	speed: 0.4352s/iter; left time: 2130.6911s
	iters: 800, epoch: 6 | loss: 0.5916832
	speed: 0.4285s/iter; left time: 2055.1454s
	iters: 900, epoch: 6 | loss: 0.8864388
	speed: 0.4367s/iter; left time: 2050.9384s
	iters: 1000, epoch: 6 | loss: 0.5687069
	speed: 0.4261s/iter; left time: 1958.3818s
	iters: 1100, epoch: 6 | loss: 0.7232345
	speed: 0.4264s/iter; left time: 1916.9734s
Epoch: 6 cost time: 482.99146938323975
Epoch: 6, Steps: 1119 | Train Loss: 0.6959399 Vali Loss: 0.7691649 Test Loss: 0.3591911
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7202495
	speed: 1.6566s/iter; left time: 7250.9290s
	iters: 200, epoch: 7 | loss: 0.6082601
	speed: 0.3565s/iter; left time: 1524.6103s
	iters: 300, epoch: 7 | loss: 0.6052895
	speed: 0.3565s/iter; left time: 1489.2553s
	iters: 400, epoch: 7 | loss: 0.5747835
	speed: 0.3588s/iter; left time: 1463.0311s
	iters: 500, epoch: 7 | loss: 0.5823687
	speed: 0.3559s/iter; left time: 1415.5465s
	iters: 600, epoch: 7 | loss: 0.7176546
	speed: 0.3538s/iter; left time: 1371.6679s
	iters: 700, epoch: 7 | loss: 0.6669118
	speed: 0.4072s/iter; left time: 1537.9107s
	iters: 800, epoch: 7 | loss: 0.6376135
	speed: 0.4298s/iter; left time: 1580.3291s
	iters: 900, epoch: 7 | loss: 0.5908636
	speed: 0.4323s/iter; left time: 1546.2692s
	iters: 1000, epoch: 7 | loss: 0.6685256
	speed: 0.4313s/iter; left time: 1499.7272s
	iters: 1100, epoch: 7 | loss: 0.6611744
	speed: 0.4297s/iter; left time: 1451.1171s
Epoch: 7 cost time: 437.5822820663452
Epoch: 7, Steps: 1119 | Train Loss: 0.6937334 Vali Loss: 0.7585483 Test Loss: 0.3662643
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_720_Crossformer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.36411556601524353, mae:0.4059445559978485
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_960     Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           960                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_960_Crossformer_custom_ftM_sl336_ll48_pl960_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35592
val 4311
test 9580
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1024    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1024                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1024_Crossformer_custom_ftM_sl336_ll48_pl1024_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35528
val 4247
test 9516
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1240    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1240                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1240_Crossformer_custom_ftM_sl336_ll48_pl1240_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35312
val 4031
test 9300
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1688    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1688                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1688_Crossformer_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34864
val 3583
test 8852
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_960     Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           960                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_960_Crossformer_custom_ftM_sl336_ll48_pl960_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35592
val 4311
test 9580
	iters: 100, epoch: 1 | loss: 0.7615005
	speed: 0.5590s/iter; left time: 6160.7892s
	iters: 200, epoch: 1 | loss: 0.6706744
	speed: 0.5029s/iter; left time: 5492.1003s
	iters: 300, epoch: 1 | loss: 0.8416401
	speed: 0.4848s/iter; left time: 5246.4511s
	iters: 400, epoch: 1 | loss: 0.9089185
	speed: 0.5090s/iter; left time: 5457.2674s
	iters: 500, epoch: 1 | loss: 0.7157768
	speed: 0.4402s/iter; left time: 4674.8566s
	iters: 600, epoch: 1 | loss: 0.7857316
	speed: 0.4512s/iter; left time: 4746.9337s
	iters: 700, epoch: 1 | loss: 0.8776248
	speed: 0.4431s/iter; left time: 4617.5272s
	iters: 800, epoch: 1 | loss: 0.6873224
	speed: 0.4474s/iter; left time: 4617.2069s
	iters: 900, epoch: 1 | loss: 0.6373554
	speed: 0.4300s/iter; left time: 4394.6765s
	iters: 1000, epoch: 1 | loss: 0.7242622
	speed: 0.4493s/iter; left time: 4547.2160s
	iters: 1100, epoch: 1 | loss: 0.6586263
	speed: 0.4596s/iter; left time: 4605.8785s
Epoch: 1 cost time: 523.4971780776978
Epoch: 1, Steps: 1112 | Train Loss: 0.8790783 Vali Loss: 0.7709097 Test Loss: 0.3917835
Validation loss decreased (inf --> 0.770910).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6969809
	speed: 1.3959s/iter; left time: 13832.2568s
	iters: 200, epoch: 2 | loss: 0.7014602
	speed: 0.4120s/iter; left time: 4041.3225s
	iters: 300, epoch: 2 | loss: 0.9365220
	speed: 0.4606s/iter; left time: 4472.0089s
	iters: 400, epoch: 2 | loss: 0.7821320
	speed: 0.4570s/iter; left time: 4391.1657s
	iters: 500, epoch: 2 | loss: 0.7154655
	speed: 0.4547s/iter; left time: 4323.6957s
	iters: 600, epoch: 2 | loss: 0.7656392
	speed: 0.4482s/iter; left time: 4216.9409s
	iters: 700, epoch: 2 | loss: 0.6997168
	speed: 0.4485s/iter; left time: 4175.0342s
	iters: 800, epoch: 2 | loss: 0.9031318
	speed: 0.4390s/iter; left time: 4042.5685s
	iters: 900, epoch: 2 | loss: 0.7374982
	speed: 0.4705s/iter; left time: 4285.8232s
	iters: 1000, epoch: 2 | loss: 0.6547872
	speed: 0.4634s/iter; left time: 4174.6278s
	iters: 1100, epoch: 2 | loss: 0.7746922
	speed: 0.4785s/iter; left time: 4263.0723s
Epoch: 2 cost time: 504.83597230911255
Epoch: 2, Steps: 1112 | Train Loss: 0.7352803 Vali Loss: 0.7626016 Test Loss: 0.3707106
Validation loss decreased (0.770910 --> 0.762602).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7519768
	speed: 1.4564s/iter; left time: 12812.0769s
	iters: 200, epoch: 3 | loss: 0.7431102
	speed: 0.4852s/iter; left time: 4220.2014s
	iters: 300, epoch: 3 | loss: 0.7456591
	speed: 0.4831s/iter; left time: 4153.6067s
	iters: 400, epoch: 3 | loss: 0.8178421
	speed: 0.4822s/iter; left time: 4097.2770s
	iters: 500, epoch: 3 | loss: 0.5898900
	speed: 0.4768s/iter; left time: 4003.8988s
	iters: 600, epoch: 3 | loss: 0.7452544
	speed: 0.4784s/iter; left time: 3969.1549s
	iters: 700, epoch: 3 | loss: 0.7889456
	speed: 0.4505s/iter; left time: 3692.5790s
	iters: 800, epoch: 3 | loss: 0.8592634
	speed: 0.4074s/iter; left time: 3298.7695s
	iters: 900, epoch: 3 | loss: 0.7250870
	speed: 0.4118s/iter; left time: 3292.9264s
	iters: 1000, epoch: 3 | loss: 0.7929229
	speed: 0.4120s/iter; left time: 3253.6348s
	iters: 1100, epoch: 3 | loss: 0.7265466
	speed: 0.4132s/iter; left time: 3221.8868s
Epoch: 3 cost time: 503.0781137943268
Epoch: 3, Steps: 1112 | Train Loss: 0.7229026 Vali Loss: 0.7750295 Test Loss: 0.3928546
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6827796
	speed: 1.4634s/iter; left time: 11246.3066s
	iters: 200, epoch: 4 | loss: 0.6771480
	speed: 0.4106s/iter; left time: 3114.5637s
	iters: 300, epoch: 4 | loss: 0.7591068
	speed: 0.4107s/iter; left time: 3073.7270s
	iters: 400, epoch: 4 | loss: 0.6259801
	speed: 0.4090s/iter; left time: 3020.1100s
	iters: 500, epoch: 4 | loss: 0.7253547
	speed: 0.4078s/iter; left time: 2970.6301s
	iters: 600, epoch: 4 | loss: 0.8124196
	speed: 0.4127s/iter; left time: 2965.4176s
	iters: 700, epoch: 4 | loss: 0.7950631
	speed: 0.4139s/iter; left time: 2932.7498s
	iters: 800, epoch: 4 | loss: 0.8152619
	speed: 0.4108s/iter; left time: 2869.3996s
	iters: 900, epoch: 4 | loss: 0.7667005
	speed: 0.4155s/iter; left time: 2860.4100s
	iters: 1000, epoch: 4 | loss: 0.6556137
	speed: 0.4134s/iter; left time: 2805.2382s
	iters: 1100, epoch: 4 | loss: 0.6449302
	speed: 0.4131s/iter; left time: 2761.4189s
Epoch: 4 cost time: 457.3939871788025
Epoch: 4, Steps: 1112 | Train Loss: 0.7168078 Vali Loss: 0.7607177 Test Loss: 0.3855536
Validation loss decreased (0.762602 --> 0.760718).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5303221
	speed: 1.4039s/iter; left time: 9227.8011s
	iters: 200, epoch: 5 | loss: 0.7949793
	speed: 0.4157s/iter; left time: 2691.0025s
	iters: 300, epoch: 5 | loss: 0.6472025
	speed: 0.4142s/iter; left time: 2639.7384s
	iters: 400, epoch: 5 | loss: 0.6657205
	speed: 0.4178s/iter; left time: 2620.6776s
	iters: 500, epoch: 5 | loss: 0.8887614
	speed: 0.4183s/iter; left time: 2582.1539s
	iters: 600, epoch: 5 | loss: 0.7580698
	speed: 0.4140s/iter; left time: 2514.2149s
	iters: 700, epoch: 5 | loss: 0.8829720
	speed: 0.4182s/iter; left time: 2497.7218s
	iters: 800, epoch: 5 | loss: 0.6368344
	speed: 0.4151s/iter; left time: 2437.6330s
	iters: 900, epoch: 5 | loss: 0.6041847
	speed: 0.4323s/iter; left time: 2495.3841s
	iters: 1000, epoch: 5 | loss: 0.7452835
	speed: 0.4394s/iter; left time: 2492.8458s
	iters: 1100, epoch: 5 | loss: 0.7671802
	speed: 0.4351s/iter; left time: 2424.7013s
Epoch: 5 cost time: 468.1415169239044
Epoch: 5, Steps: 1112 | Train Loss: 0.7121972 Vali Loss: 0.7627708 Test Loss: 0.3816298
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7438208
	speed: 1.4972s/iter; left time: 8176.0858s
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_960     Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           960                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_960_Crossformer_custom_ftM_sl336_ll48_pl960_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35592
val 4311
test 9580
	iters: 100, epoch: 1 | loss: 0.7666892
	speed: 0.4398s/iter; left time: 4847.0650s
	iters: 200, epoch: 1 | loss: 0.6659481
	speed: 0.4437s/iter; left time: 4845.3446s
	iters: 300, epoch: 1 | loss: 0.8495365
	speed: 0.4475s/iter; left time: 4842.3687s
	iters: 400, epoch: 1 | loss: 0.9395281
	speed: 0.4456s/iter; left time: 4776.7971s
	iters: 500, epoch: 1 | loss: 0.7142989
	speed: 0.4481s/iter; left time: 4759.0901s
	iters: 600, epoch: 1 | loss: 0.7836187
	speed: 0.4335s/iter; left time: 4560.8564s
	iters: 700, epoch: 1 | loss: 0.8808962
	speed: 0.4464s/iter; left time: 4651.6447s
	iters: 800, epoch: 1 | loss: 0.6891245
	speed: 0.4530s/iter; left time: 4675.0443s
	iters: 900, epoch: 1 | loss: 0.6418367
	speed: 0.4536s/iter; left time: 4635.9909s
	iters: 1000, epoch: 1 | loss: 0.7226685
	speed: 0.4557s/iter; left time: 4612.0363s
	iters: 1100, epoch: 1 | loss: 0.6731489
	speed: 0.4568s/iter; left time: 4578.0068s
Epoch: 1 cost time: 498.0788815021515
Epoch: 1, Steps: 1112 | Train Loss: 0.8677306 Vali Loss: 0.7671794 Test Loss: 0.3858213
Validation loss decreased (inf --> 0.767179).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6960112
	speed: 1.3845s/iter; left time: 13719.1027s
	iters: 200, epoch: 2 | loss: 0.6981269
	speed: 0.4627s/iter; left time: 4538.9124s
	iters: 300, epoch: 2 | loss: 0.9237779
	speed: 0.4584s/iter; left time: 4450.4909s
	iters: 400, epoch: 2 | loss: 0.7777151
	speed: 0.4630s/iter; left time: 4448.9888s
	iters: 500, epoch: 2 | loss: 0.6928110
	speed: 0.4665s/iter; left time: 4436.0490s
	iters: 600, epoch: 2 | loss: 0.7698663
	speed: 0.4656s/iter; left time: 4380.8021s
	iters: 700, epoch: 2 | loss: 0.6945601
	speed: 0.4665s/iter; left time: 4343.0305s
	iters: 800, epoch: 2 | loss: 0.8970172
	speed: 0.4336s/iter; left time: 3993.2238s
	iters: 900, epoch: 2 | loss: 0.7362170
	speed: 0.4794s/iter; left time: 4367.2160s
	iters: 1000, epoch: 2 | loss: 0.6532615
	speed: 0.4833s/iter; left time: 4353.6749s
	iters: 1100, epoch: 2 | loss: 0.7815812
	speed: 0.4814s/iter; left time: 4288.7538s
Epoch: 2 cost time: 512.8835792541504
Epoch: 2, Steps: 1112 | Train Loss: 0.7342855 Vali Loss: 0.7646150 Test Loss: 0.3709888
Validation loss decreased (0.767179 --> 0.764615).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7521570
	speed: 1.5535s/iter; left time: 13666.2346s
	iters: 200, epoch: 3 | loss: 0.7381842
	speed: 0.4943s/iter; left time: 4298.5009s
	iters: 300, epoch: 3 | loss: 0.7440699
	speed: 0.4869s/iter; left time: 4186.0795s
	iters: 400, epoch: 3 | loss: 0.8169216
	speed: 0.4192s/iter; left time: 3561.8790s
	iters: 500, epoch: 3 | loss: 0.5818366
	speed: 0.4067s/iter; left time: 3415.3957s
	iters: 600, epoch: 3 | loss: 0.7416691
	speed: 0.4135s/iter; left time: 3430.4575s
	iters: 700, epoch: 3 | loss: 0.7884677
	speed: 0.4123s/iter; left time: 3379.8457s
	iters: 800, epoch: 3 | loss: 0.8733861
	speed: 0.4104s/iter; left time: 3323.3693s
	iters: 900, epoch: 3 | loss: 0.7216104
	speed: 0.4115s/iter; left time: 3290.9152s
	iters: 1000, epoch: 3 | loss: 0.7914201
	speed: 0.4115s/iter; left time: 3249.7276s
	iters: 1100, epoch: 3 | loss: 0.7219188
	speed: 0.4100s/iter; left time: 3196.6482s
Epoch: 3 cost time: 481.30751729011536
Epoch: 3, Steps: 1112 | Train Loss: 0.7213912 Vali Loss: 0.7952304 Test Loss: 0.4003526
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6832901
	speed: 1.3368s/iter; left time: 10273.3636s
	iters: 200, epoch: 4 | loss: 0.6739370
	speed: 0.4122s/iter; left time: 3126.5038s
	iters: 300, epoch: 4 | loss: 0.7517582
	speed: 0.4123s/iter; left time: 3085.8679s
	iters: 400, epoch: 4 | loss: 0.6268077
	speed: 0.4137s/iter; left time: 3054.8308s
	iters: 500, epoch: 4 | loss: 0.7301515
	speed: 0.4123s/iter; left time: 3003.8601s
	iters: 600, epoch: 4 | loss: 0.8124427
	speed: 0.4072s/iter; left time: 2926.0787s
	iters: 700, epoch: 4 | loss: 0.7858566
	speed: 0.4220s/iter; left time: 2989.6940s
	iters: 800, epoch: 4 | loss: 0.8121272
	speed: 0.4199s/iter; left time: 2933.0321s
	iters: 900, epoch: 4 | loss: 0.7635243
	speed: 0.4204s/iter; left time: 2894.6319s
	iters: 1000, epoch: 4 | loss: 0.6513643
	speed: 0.4176s/iter; left time: 2833.3202s
	iters: 1100, epoch: 4 | loss: 0.6490346
	speed: 0.4193s/iter; left time: 2803.1232s
Epoch: 4 cost time: 461.7174849510193
Epoch: 4, Steps: 1112 | Train Loss: 0.7153609 Vali Loss: 0.7656470 Test Loss: 0.3811259
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5326815
	speed: 1.3458s/iter; left time: 8846.0061s
	iters: 200, epoch: 5 | loss: 0.7997754
	speed: 0.4382s/iter; left time: 2836.2362s
	iters: 300, epoch: 5 | loss: 0.6384261
	speed: 0.4373s/iter; left time: 2786.7960s
	iters: 400, epoch: 5 | loss: 0.6660316
	speed: 0.4412s/iter; left time: 2767.7290s
	iters: 500, epoch: 5 | loss: 0.8818186
	speed: 0.4396s/iter; left time: 2713.5818s
	iters: 600, epoch: 5 | loss: 0.7613474
	speed: 0.4274s/iter; left time: 2595.5295s
	iters: 700, epoch: 5 | loss: 0.8787842
	speed: 0.4467s/iter; left time: 2668.3774s
	iters: 800, epoch: 5 | loss: 0.6385835
	speed: 0.4489s/iter; left time: 2636.3353s
	iters: 900, epoch: 5 | loss: 0.6040488
	speed: 0.4504s/iter; left time: 2599.9178s
	iters: 1000, epoch: 5 | loss: 0.7445278
	speed: 0.4514s/iter; left time: 2560.5410s
	iters: 1100, epoch: 5 | loss: 0.7672061
	speed: 0.4512s/iter; left time: 2514.7078s
Epoch: 5 cost time: 492.79549050331116
Epoch: 5, Steps: 1112 | Train Loss: 0.7114106 Vali Loss: 0.7732537 Test Loss: 0.3823897
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7472799
	speed: 1.4166s/iter; left time: 7735.8546s
	iters: 200, epoch: 6 | loss: 0.6998034
	speed: 0.4525s/iter; left time: 2425.8942s
	iters: 300, epoch: 6 | loss: 0.6682793
	speed: 0.4512s/iter; left time: 2373.6528s
	iters: 400, epoch: 6 | loss: 0.6976234
	speed: 0.4544s/iter; left time: 2345.3502s
	iters: 500, epoch: 6 | loss: 0.5830404
	speed: 0.4497s/iter; left time: 2275.8227s
	iters: 600, epoch: 6 | loss: 0.7923689
	speed: 0.4549s/iter; left time: 2256.5257s
	iters: 700, epoch: 6 | loss: 0.8385928
	speed: 0.4603s/iter; left time: 2237.5500s
	iters: 800, epoch: 6 | loss: 0.7800087
	speed: 0.4591s/iter; left time: 2185.7812s
	iters: 900, epoch: 6 | loss: 0.8251728
	speed: 0.4603s/iter; left time: 2145.6442s
	iters: 1000, epoch: 6 | loss: 0.7235609
	speed: 0.4636s/iter; left time: 2114.4142s
	iters: 1100, epoch: 6 | loss: 0.6186831
	speed: 0.4691s/iter; left time: 2092.7438s
Epoch: 6 cost time: 508.199583530426
Epoch: 6, Steps: 1112 | Train Loss: 0.7082046 Vali Loss: 0.7910481 Test Loss: 0.3978782
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7370483
	speed: 1.3937s/iter; left time: 6061.1869s
	iters: 200, epoch: 7 | loss: 0.6157578
	speed: 0.4777s/iter; left time: 2029.7396s
	iters: 300, epoch: 7 | loss: 0.7036506
	speed: 0.4815s/iter; left time: 1997.5593s
	iters: 400, epoch: 7 | loss: 0.5682230
	speed: 0.4787s/iter; left time: 1938.2525s
	iters: 500, epoch: 7 | loss: 0.6069937
	speed: 0.4736s/iter; left time: 1870.3026s
	iters: 600, epoch: 7 | loss: 0.7858106
	speed: 0.4879s/iter; left time: 1877.9255s
	iters: 700, epoch: 7 | loss: 0.6566184
	speed: 0.4887s/iter; left time: 1832.2381s
	iters: 800, epoch: 7 | loss: 0.6152002
	speed: 0.4905s/iter; left time: 1789.8073s
	iters: 900, epoch: 7 | loss: 0.7493993
	speed: 0.4130s/iter; left time: 1465.5816s
	iters: 1000, epoch: 7 | loss: 0.8494442
	speed: 0.3988s/iter; left time: 1375.6146s
	iters: 1100, epoch: 7 | loss: 0.7317459
	speed: 0.3983s/iter; left time: 1333.7715s
Epoch: 7 cost time: 508.4124450683594
Epoch: 7, Steps: 1112 | Train Loss: 0.7059590 Vali Loss: 0.7892193 Test Loss: 0.3934213
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_960_Crossformer_custom_ftM_sl336_ll48_pl960_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9580
test shape: (9580, 960, 21) (9580, 960, 21)
test shape: (9580, 960, 21) (9580, 960, 21)
mse:0.3709885776042938, mae:0.3934026062488556
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1024    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1024                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1024_Crossformer_custom_ftM_sl336_ll48_pl1024_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35528
val 4247
test 9516
	iters: 100, epoch: 1 | loss: 0.8044010
	speed: 0.4248s/iter; left time: 4672.9801s
	iters: 200, epoch: 1 | loss: 0.7142717
	speed: 0.4239s/iter; left time: 4620.9789s
	iters: 300, epoch: 1 | loss: 0.7567549
	speed: 0.4268s/iter; left time: 4610.0288s
	iters: 400, epoch: 1 | loss: 0.7486984
	speed: 0.4262s/iter; left time: 4560.4570s
	iters: 500, epoch: 1 | loss: 0.7387466
	speed: 0.4275s/iter; left time: 4531.4696s
	iters: 600, epoch: 1 | loss: 0.7400090
	speed: 0.4242s/iter; left time: 4454.5994s
	iters: 700, epoch: 1 | loss: 0.6674159
	speed: 0.4271s/iter; left time: 4441.8649s
	iters: 800, epoch: 1 | loss: 0.6867234
	speed: 0.4252s/iter; left time: 4380.3386s
	iters: 900, epoch: 1 | loss: 0.6315594
	speed: 0.4247s/iter; left time: 4332.2762s
	iters: 1000, epoch: 1 | loss: 0.8192754
	speed: 0.4247s/iter; left time: 4289.4025s
	iters: 1100, epoch: 1 | loss: 0.7118095
	speed: 0.4266s/iter; left time: 4266.6727s
Epoch: 1 cost time: 472.5201807022095
Epoch: 1, Steps: 1110 | Train Loss: 0.8731629 Vali Loss: 0.7730454 Test Loss: 0.3906988
Validation loss decreased (inf --> 0.773045).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6800693
	speed: 1.2856s/iter; left time: 12716.0376s
	iters: 200, epoch: 2 | loss: 0.6554790
	speed: 0.4208s/iter; left time: 4120.4676s
	iters: 300, epoch: 2 | loss: 0.6429832
	speed: 0.4231s/iter; left time: 4099.8163s
	iters: 400, epoch: 2 | loss: 0.7860440
	speed: 0.4211s/iter; left time: 4038.7772s
	iters: 500, epoch: 2 | loss: 0.6973509
	speed: 0.4243s/iter; left time: 4026.7024s
	iters: 600, epoch: 2 | loss: 0.6419098
	speed: 0.4230s/iter; left time: 3972.1507s
	iters: 700, epoch: 2 | loss: 0.6804536
	speed: 0.4232s/iter; left time: 3932.0703s
	iters: 800, epoch: 2 | loss: 0.9927602
	speed: 0.4199s/iter; left time: 3859.2897s
	iters: 900, epoch: 2 | loss: 0.7463951
	speed: 0.4233s/iter; left time: 3848.2861s
	iters: 1000, epoch: 2 | loss: 0.7071266
	speed: 0.4292s/iter; left time: 3858.8409s
	iters: 1100, epoch: 2 | loss: 0.7006378
	speed: 0.4186s/iter; left time: 3721.9072s
Epoch: 2 cost time: 469.6083915233612
Epoch: 2, Steps: 1110 | Train Loss: 0.7394762 Vali Loss: 0.8243862 Test Loss: 0.4246693
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6354940
	speed: 1.2674s/iter; left time: 11129.0027s
	iters: 200, epoch: 3 | loss: 0.7835528
	speed: 0.4189s/iter; left time: 3636.6044s
	iters: 300, epoch: 3 | loss: 0.7195297
	speed: 0.4202s/iter; left time: 3605.3113s
	iters: 400, epoch: 3 | loss: 0.8557076
	speed: 0.4202s/iter; left time: 3564.0099s
	iters: 500, epoch: 3 | loss: 0.6580768
	speed: 0.4205s/iter; left time: 3524.4075s
	iters: 600, epoch: 3 | loss: 0.6780655
	speed: 0.4248s/iter; left time: 3517.7335s
	iters: 700, epoch: 3 | loss: 0.6730734
	speed: 0.4205s/iter; left time: 3439.8927s
	iters: 800, epoch: 3 | loss: 0.8535076
	speed: 0.4255s/iter; left time: 3438.5045s
	iters: 900, epoch: 3 | loss: 0.7264164
	speed: 0.4254s/iter; left time: 3394.9160s
	iters: 1000, epoch: 3 | loss: 0.7009373
	speed: 0.4222s/iter; left time: 3327.1435s
	iters: 1100, epoch: 3 | loss: 0.7602403
	speed: 0.4211s/iter; left time: 3276.2594s
Epoch: 3 cost time: 468.6094317436218
Epoch: 3, Steps: 1110 | Train Loss: 0.7236019 Vali Loss: 0.7555872 Test Loss: 0.3771953
Validation loss decreased (0.773045 --> 0.755587).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7854006
	speed: 1.2915s/iter; left time: 9907.0195s
	iters: 200, epoch: 4 | loss: 0.6796793
	speed: 0.4200s/iter; left time: 3179.8330s
	iters: 300, epoch: 4 | loss: 0.7216590
	speed: 0.4197s/iter; left time: 3135.6215s
	iters: 400, epoch: 4 | loss: 0.8299239
	speed: 0.4218s/iter; left time: 3109.0132s
	iters: 500, epoch: 4 | loss: 0.6191274
	speed: 0.4251s/iter; left time: 3090.7036s
	iters: 600, epoch: 4 | loss: 0.5974340
	speed: 0.4220s/iter; left time: 3026.2061s
	iters: 700, epoch: 4 | loss: 0.5747377
	speed: 0.4233s/iter; left time: 2993.3378s
	iters: 800, epoch: 4 | loss: 0.7440587
	speed: 0.4224s/iter; left time: 2944.4496s
	iters: 900, epoch: 4 | loss: 0.7926988
	speed: 0.4191s/iter; left time: 2879.9221s
	iters: 1000, epoch: 4 | loss: 0.7269111
	speed: 0.4272s/iter; left time: 2892.4504s
	iters: 1100, epoch: 4 | loss: 0.6408556
	speed: 0.4228s/iter; left time: 2820.4673s
Epoch: 4 cost time: 468.5827784538269
Epoch: 4, Steps: 1110 | Train Loss: 0.7183124 Vali Loss: 0.7639151 Test Loss: 0.3823878
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6775577
	speed: 1.2931s/iter; left time: 8484.2458s
	iters: 200, epoch: 5 | loss: 0.7189617
	speed: 0.4199s/iter; left time: 2712.9937s
	iters: 300, epoch: 5 | loss: 0.6254855
	speed: 0.4195s/iter; left time: 2668.5241s
	iters: 400, epoch: 5 | loss: 0.5967032
	speed: 0.4260s/iter; left time: 2667.4530s
	iters: 500, epoch: 5 | loss: 0.6104575
	speed: 0.4227s/iter; left time: 2604.1838s
	iters: 600, epoch: 5 | loss: 0.6839784
	speed: 0.4204s/iter; left time: 2547.8655s
	iters: 700, epoch: 5 | loss: 0.6578181
	speed: 0.4224s/iter; left time: 2517.7696s
	iters: 800, epoch: 5 | loss: 0.7612314
	speed: 0.4233s/iter; left time: 2480.7293s
	iters: 900, epoch: 5 | loss: 0.6077338
	speed: 0.4212s/iter; left time: 2426.3351s
	iters: 1000, epoch: 5 | loss: 0.6708754
	speed: 0.4224s/iter; left time: 2391.0093s
	iters: 1100, epoch: 5 | loss: 0.6808073
	speed: 0.4241s/iter; left time: 2358.4413s
Epoch: 5 cost time: 468.7257516384125
Epoch: 5, Steps: 1110 | Train Loss: 0.7142288 Vali Loss: 0.8066085 Test Loss: 0.3957125
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6047548
	speed: 1.1636s/iter; left time: 6342.7729s
	iters: 200, epoch: 6 | loss: 1.0542798
	speed: 0.4152s/iter; left time: 2221.5710s
	iters: 300, epoch: 6 | loss: 0.7272430
	speed: 0.4140s/iter; left time: 2173.8276s
	iters: 400, epoch: 6 | loss: 0.6861566
	speed: 0.4133s/iter; left time: 2129.0319s
	iters: 500, epoch: 6 | loss: 0.6176768
	speed: 0.4120s/iter; left time: 2081.0768s
	iters: 600, epoch: 6 | loss: 0.6449813
	speed: 0.4116s/iter; left time: 2037.7997s
	iters: 700, epoch: 6 | loss: 0.6798126
	speed: 0.4111s/iter; left time: 1994.4738s
	iters: 800, epoch: 6 | loss: 0.7335638
	speed: 0.4109s/iter; left time: 1951.9716s
	iters: 900, epoch: 6 | loss: 0.7224095
	speed: 0.4107s/iter; left time: 1910.0327s
	iters: 1000, epoch: 6 | loss: 0.7935085
	speed: 0.4098s/iter; left time: 1864.8687s
	iters: 1100, epoch: 6 | loss: 0.7558363
	speed: 0.4096s/iter; left time: 1823.2904s
Epoch: 6 cost time: 457.5512385368347
Epoch: 6, Steps: 1110 | Train Loss: 0.7113725 Vali Loss: 0.7698568 Test Loss: 0.3895811
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5925907
	speed: 1.0713s/iter; left time: 4650.4625s
	iters: 200, epoch: 7 | loss: 0.6926845
	speed: 0.4085s/iter; left time: 1732.5392s
	iters: 300, epoch: 7 | loss: 0.8101906
	speed: 0.4081s/iter; left time: 1689.7979s
	iters: 400, epoch: 7 | loss: 0.7872754
	speed: 0.4088s/iter; left time: 1652.0755s
	iters: 500, epoch: 7 | loss: 0.6941323
	speed: 0.4087s/iter; left time: 1610.8042s
	iters: 600, epoch: 7 | loss: 0.7381014
	speed: 0.4087s/iter; left time: 1569.8113s
	iters: 700, epoch: 7 | loss: 0.7437611
	speed: 0.4083s/iter; left time: 1527.4943s
	iters: 800, epoch: 7 | loss: 0.7466936
	speed: 0.4083s/iter; left time: 1486.5698s
	iters: 900, epoch: 7 | loss: 0.6429311
	speed: 0.4083s/iter; left time: 1445.9262s
	iters: 1000, epoch: 7 | loss: 0.7812229
	speed: 0.4080s/iter; left time: 1403.9893s
	iters: 1100, epoch: 7 | loss: 0.7342684
	speed: 0.4078s/iter; left time: 1362.3457s
Epoch: 7 cost time: 453.23555970191956
Epoch: 7, Steps: 1110 | Train Loss: 0.7092526 Vali Loss: 0.7995732 Test Loss: 0.4050179
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6116787
	speed: 1.0834s/iter; left time: 3500.3054s
	iters: 200, epoch: 8 | loss: 0.6052859
	speed: 0.4138s/iter; left time: 1295.6123s
	iters: 300, epoch: 8 | loss: 0.7628361
	speed: 0.4138s/iter; left time: 1254.0895s
	iters: 400, epoch: 8 | loss: 0.7484470
	speed: 0.4142s/iter; left time: 1213.9253s
	iters: 500, epoch: 8 | loss: 0.7021157
	speed: 0.4149s/iter; left time: 1174.6490s
	iters: 600, epoch: 8 | loss: 0.6839069
	speed: 0.4141s/iter; left time: 1130.8729s
	iters: 700, epoch: 8 | loss: 0.6427318
	speed: 0.4146s/iter; left time: 1090.6925s
	iters: 800, epoch: 8 | loss: 0.6519428
	speed: 0.4131s/iter; left time: 1045.6315s
	iters: 900, epoch: 8 | loss: 0.6340169
	speed: 0.4143s/iter; left time: 1007.0715s
	iters: 1000, epoch: 8 | loss: 0.9363127
	speed: 0.4146s/iter; left time: 966.4004s
	iters: 1100, epoch: 8 | loss: 0.6385533
	speed: 0.4155s/iter; left time: 927.0436s
Epoch: 8 cost time: 459.7199490070343
Epoch: 8, Steps: 1110 | Train Loss: 0.7068958 Vali Loss: 0.7814679 Test Loss: 0.3957308
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_1024_Crossformer_custom_ftM_sl336_ll48_pl1024_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9516
test shape: (9516, 1024, 21) (9516, 1024, 21)
test shape: (9516, 1024, 21) (9516, 1024, 21)
mse:0.3771948218345642, mae:0.4045446813106537
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1240    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1240                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1240_Crossformer_custom_ftM_sl336_ll48_pl1240_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35312
val 4031
test 9300
	iters: 100, epoch: 1 | loss: 0.9372744
	speed: 0.4748s/iter; left time: 5190.1049s
	iters: 200, epoch: 1 | loss: 0.7500805
	speed: 0.4770s/iter; left time: 5166.9165s
	iters: 300, epoch: 1 | loss: 0.7597436
	speed: 0.4780s/iter; left time: 5129.2586s
	iters: 400, epoch: 1 | loss: 0.7366926
	speed: 0.4781s/iter; left time: 5082.2586s
	iters: 500, epoch: 1 | loss: 0.8939478
	speed: 0.4779s/iter; left time: 5033.1785s
	iters: 600, epoch: 1 | loss: 0.6527427
	speed: 0.4779s/iter; left time: 4984.8098s
	iters: 700, epoch: 1 | loss: 0.6532709
	speed: 0.4779s/iter; left time: 4937.0557s
	iters: 800, epoch: 1 | loss: 0.9027363
	speed: 0.4782s/iter; left time: 4892.4838s
	iters: 900, epoch: 1 | loss: 0.7772462
	speed: 0.4784s/iter; left time: 4846.8461s
	iters: 1000, epoch: 1 | loss: 0.6813028
	speed: 0.4784s/iter; left time: 4799.3211s
	iters: 1100, epoch: 1 | loss: 0.7240909
	speed: 0.4779s/iter; left time: 4745.9018s
Epoch: 1 cost time: 526.9826209545135
Epoch: 1, Steps: 1103 | Train Loss: 0.8841341 Vali Loss: 0.8115450 Test Loss: 0.3968825
Validation loss decreased (inf --> 0.811545).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7293294
	speed: 1.2274s/iter; left time: 12062.7724s
	iters: 200, epoch: 2 | loss: 0.7136663
	speed: 0.4847s/iter; left time: 4714.9734s
	iters: 300, epoch: 2 | loss: 0.7496653
	speed: 0.4852s/iter; left time: 4671.2561s
	iters: 400, epoch: 2 | loss: 0.6961156
	speed: 0.4852s/iter; left time: 4623.0449s
	iters: 500, epoch: 2 | loss: 0.5712000
	speed: 0.4849s/iter; left time: 4571.8116s
	iters: 600, epoch: 2 | loss: 0.8072793
	speed: 0.4854s/iter; left time: 4527.4944s
	iters: 700, epoch: 2 | loss: 0.7955781
	speed: 0.4847s/iter; left time: 4472.5306s
	iters: 800, epoch: 2 | loss: 0.7843969
	speed: 0.4843s/iter; left time: 4420.9113s
	iters: 900, epoch: 2 | loss: 0.7149315
	speed: 0.4853s/iter; left time: 4381.7345s
	iters: 1000, epoch: 2 | loss: 0.6061320
	speed: 0.4844s/iter; left time: 4324.3597s
	iters: 1100, epoch: 2 | loss: 0.7913954
	speed: 0.4847s/iter; left time: 4278.9797s
Epoch: 2 cost time: 534.6744821071625
Epoch: 2, Steps: 1103 | Train Loss: 0.7447143 Vali Loss: 0.7935953 Test Loss: 0.3953845
Validation loss decreased (0.811545 --> 0.793595).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7722082
	speed: 1.2288s/iter; left time: 10721.0092s
	iters: 200, epoch: 3 | loss: 0.7121617
	speed: 0.4767s/iter; left time: 4111.5958s
	iters: 300, epoch: 3 | loss: 0.7296582
	speed: 0.4766s/iter; left time: 4062.6630s
	iters: 400, epoch: 3 | loss: 0.6042258
	speed: 0.4770s/iter; left time: 4019.0879s
	iters: 500, epoch: 3 | loss: 0.6188552
	speed: 0.4775s/iter; left time: 3975.4246s
	iters: 600, epoch: 3 | loss: 0.7617334
	speed: 0.4770s/iter; left time: 3923.3011s
	iters: 700, epoch: 3 | loss: 0.6975772
	speed: 0.4765s/iter; left time: 3871.4412s
	iters: 800, epoch: 3 | loss: 0.7722212
	speed: 0.4772s/iter; left time: 3829.8121s
	iters: 900, epoch: 3 | loss: 0.7266586
	speed: 0.4770s/iter; left time: 3780.0143s
	iters: 1000, epoch: 3 | loss: 0.7355041
	speed: 0.4772s/iter; left time: 3734.2719s
	iters: 1100, epoch: 3 | loss: 0.7685219
	speed: 0.4770s/iter; left time: 3684.6406s
Epoch: 3 cost time: 526.004519701004
Epoch: 3, Steps: 1103 | Train Loss: 0.7304946 Vali Loss: 0.8195686 Test Loss: 0.3931507
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7212960
	speed: 1.2234s/iter; left time: 9324.5481s
	iters: 200, epoch: 4 | loss: 0.6531113
	speed: 0.4777s/iter; left time: 3593.0584s
	iters: 300, epoch: 4 | loss: 0.6811015
	speed: 0.4776s/iter; left time: 3544.8465s
	iters: 400, epoch: 4 | loss: 0.8198756
	speed: 0.4770s/iter; left time: 3492.4508s
	iters: 500, epoch: 4 | loss: 0.8003606
	speed: 0.4763s/iter; left time: 3439.5001s
	iters: 600, epoch: 4 | loss: 0.7970129
	speed: 0.4769s/iter; left time: 3396.4725s
	iters: 700, epoch: 4 | loss: 0.6553835
	speed: 0.4768s/iter; left time: 3347.9778s
	iters: 800, epoch: 4 | loss: 0.7033387
	speed: 0.4765s/iter; left time: 3298.1924s
	iters: 900, epoch: 4 | loss: 0.8002757
	speed: 0.4764s/iter; left time: 3250.1002s
	iters: 1000, epoch: 4 | loss: 0.7545678
	speed: 0.4767s/iter; left time: 3204.3061s
	iters: 1100, epoch: 4 | loss: 0.7881671
	speed: 0.4767s/iter; left time: 3156.8732s
Epoch: 4 cost time: 525.9769268035889
Epoch: 4, Steps: 1103 | Train Loss: 0.7257293 Vali Loss: 0.7928027 Test Loss: 0.3959220
Validation loss decreased (0.793595 --> 0.792803).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7542456
	speed: 1.2273s/iter; left time: 8000.8638s
	iters: 200, epoch: 5 | loss: 0.8378286
	speed: 0.4815s/iter; left time: 3090.6896s
	iters: 300, epoch: 5 | loss: 0.6648118
	speed: 0.4819s/iter; left time: 3045.0060s
	iters: 400, epoch: 5 | loss: 0.6838179
	speed: 0.4819s/iter; left time: 2996.8777s
	iters: 500, epoch: 5 | loss: 0.5849776
	speed: 0.4814s/iter; left time: 2945.8573s
	iters: 600, epoch: 5 | loss: 0.7097183
	speed: 0.4820s/iter; left time: 2900.8827s
	iters: 700, epoch: 5 | loss: 0.7745416
	speed: 0.4817s/iter; left time: 2851.2290s
	iters: 800, epoch: 5 | loss: 0.8724141
	speed: 0.4817s/iter; left time: 2802.9987s
	iters: 900, epoch: 5 | loss: 0.6806768
	speed: 0.4815s/iter; left time: 2753.5120s
	iters: 1000, epoch: 5 | loss: 0.7194400
	speed: 0.4810s/iter; left time: 2702.8424s
	iters: 1100, epoch: 5 | loss: 0.6545255
	speed: 0.4815s/iter; left time: 2657.1936s
Epoch: 5 cost time: 531.1014413833618
Epoch: 5, Steps: 1103 | Train Loss: 0.7207862 Vali Loss: 0.7920474 Test Loss: 0.3890796
Validation loss decreased (0.792803 --> 0.792047).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5996522
	speed: 1.2333s/iter; left time: 6679.4094s
	iters: 200, epoch: 6 | loss: 0.8562917
	speed: 0.4769s/iter; left time: 2535.1316s
	iters: 300, epoch: 6 | loss: 0.7383472
	speed: 0.4765s/iter; left time: 2485.4372s
	iters: 400, epoch: 6 | loss: 0.7961956
	speed: 0.4770s/iter; left time: 2440.3127s
	iters: 500, epoch: 6 | loss: 0.7171327
	speed: 0.4780s/iter; left time: 2397.8485s
	iters: 600, epoch: 6 | loss: 0.6553817
	speed: 0.4775s/iter; left time: 2347.4423s
	iters: 700, epoch: 6 | loss: 0.5944188
	speed: 0.4781s/iter; left time: 2302.6907s
	iters: 800, epoch: 6 | loss: 0.7311776
	speed: 0.4781s/iter; left time: 2254.7482s
	iters: 900, epoch: 6 | loss: 0.6810356
	speed: 0.4785s/iter; left time: 2208.9794s
	iters: 1000, epoch: 6 | loss: 0.6925384
	speed: 0.4787s/iter; left time: 2161.8787s
	iters: 1100, epoch: 6 | loss: 0.7318601
	speed: 0.4787s/iter; left time: 2113.7297s
Epoch: 6 cost time: 526.9109830856323
Epoch: 6, Steps: 1103 | Train Loss: 0.7179781 Vali Loss: 0.8119488 Test Loss: 0.4023878
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.6748466
	speed: 1.2203s/iter; left time: 5263.2561s
	iters: 200, epoch: 7 | loss: 0.6937246
	speed: 0.4777s/iter; left time: 2012.4557s
	iters: 300, epoch: 7 | loss: 0.6294241
	speed: 0.4781s/iter; left time: 1966.6030s
	iters: 400, epoch: 7 | loss: 0.8503566
	speed: 0.4770s/iter; left time: 1914.0257s
	iters: 500, epoch: 7 | loss: 0.7897492
	speed: 0.4771s/iter; left time: 1867.0359s
	iters: 600, epoch: 7 | loss: 0.5901502
	speed: 0.4776s/iter; left time: 1821.1208s
	iters: 700, epoch: 7 | loss: 0.6345131
	speed: 0.4767s/iter; left time: 1770.1021s
	iters: 800, epoch: 7 | loss: 0.6391070
	speed: 0.4765s/iter; left time: 1721.4666s
	iters: 900, epoch: 7 | loss: 0.5950100
	speed: 0.4770s/iter; left time: 1675.8449s
	iters: 1000, epoch: 7 | loss: 0.8062179
	speed: 0.4772s/iter; left time: 1628.6019s
	iters: 1100, epoch: 7 | loss: 0.7498261
	speed: 0.4772s/iter; left time: 1580.9219s
Epoch: 7 cost time: 526.338259935379
Epoch: 7, Steps: 1103 | Train Loss: 0.7154275 Vali Loss: 0.8033419 Test Loss: 0.3950680
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.7517042
	speed: 1.2266s/iter; left time: 3937.3037s
	iters: 200, epoch: 8 | loss: 0.7219192
	speed: 0.4830s/iter; left time: 1502.1682s
	iters: 300, epoch: 8 | loss: 0.7652819
	speed: 0.4828s/iter; left time: 1453.1679s
	iters: 400, epoch: 8 | loss: 0.6968490
	speed: 0.4834s/iter; left time: 1406.6445s
	iters: 500, epoch: 8 | loss: 0.7649390
	speed: 0.4835s/iter; left time: 1358.6383s
	iters: 600, epoch: 8 | loss: 0.6236960
	speed: 0.4845s/iter; left time: 1312.8903s
	iters: 700, epoch: 8 | loss: 0.6919347
	speed: 0.4837s/iter; left time: 1262.4770s
	iters: 800, epoch: 8 | loss: 0.6929048
	speed: 0.4836s/iter; left time: 1213.8769s
	iters: 900, epoch: 8 | loss: 0.6951323
	speed: 0.4834s/iter; left time: 1164.8915s
	iters: 1000, epoch: 8 | loss: 0.7513306
	speed: 0.4830s/iter; left time: 1115.6921s
	iters: 1100, epoch: 8 | loss: 0.6557113
	speed: 0.4829s/iter; left time: 1067.2859s
Epoch: 8 cost time: 533.0615711212158
Epoch: 8, Steps: 1103 | Train Loss: 0.7140037 Vali Loss: 0.8255598 Test Loss: 0.4054368
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.7480751
	speed: 1.2302s/iter; left time: 2592.1263s
	iters: 200, epoch: 9 | loss: 0.6632046
	speed: 0.4828s/iter; left time: 969.0416s
	iters: 300, epoch: 9 | loss: 0.6945023
	speed: 0.4828s/iter; left time: 920.6078s
	iters: 400, epoch: 9 | loss: 0.6582128
	speed: 0.4824s/iter; left time: 871.6165s
	iters: 500, epoch: 9 | loss: 0.7698811
	speed: 0.4828s/iter; left time: 824.1239s
	iters: 600, epoch: 9 | loss: 0.6886624
	speed: 0.4831s/iter; left time: 776.2671s
	iters: 700, epoch: 9 | loss: 0.6056817
	speed: 0.4821s/iter; left time: 726.5397s
	iters: 800, epoch: 9 | loss: 0.7418194
	speed: 0.4824s/iter; left time: 678.7747s
	iters: 900, epoch: 9 | loss: 0.6917024
	speed: 0.4825s/iter; left time: 630.5932s
	iters: 1000, epoch: 9 | loss: 0.6454721
	speed: 0.4826s/iter; left time: 582.5214s
	iters: 1100, epoch: 9 | loss: 0.7278755
	speed: 0.4822s/iter; left time: 533.8507s
Epoch: 9 cost time: 532.1851794719696
Epoch: 9, Steps: 1103 | Train Loss: 0.7132164 Vali Loss: 0.8089748 Test Loss: 0.4033220
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7425545
	speed: 1.2297s/iter; left time: 1234.5737s
	iters: 200, epoch: 10 | loss: 0.7906113
	speed: 0.4814s/iter; left time: 435.2162s
	iters: 300, epoch: 10 | loss: 0.6556779
	speed: 0.4822s/iter; left time: 387.6974s
	iters: 400, epoch: 10 | loss: 0.6804847
	speed: 0.4815s/iter; left time: 338.9846s
	iters: 500, epoch: 10 | loss: 0.6784373
	speed: 0.4818s/iter; left time: 291.0256s
	iters: 600, epoch: 10 | loss: 0.6946020
	speed: 0.4824s/iter; left time: 243.1223s
	iters: 700, epoch: 10 | loss: 0.6168413
	speed: 0.4818s/iter; left time: 194.6399s
	iters: 800, epoch: 10 | loss: 0.7767810
	speed: 0.4822s/iter; left time: 146.5927s
	iters: 900, epoch: 10 | loss: 0.7492310
	speed: 0.4818s/iter; left time: 98.2827s
	iters: 1000, epoch: 10 | loss: 0.7208803
	speed: 0.4812s/iter; left time: 50.0481s
	iters: 1100, epoch: 10 | loss: 0.5764070
	speed: 0.4814s/iter; left time: 1.9254s
Epoch: 10 cost time: 531.3227264881134
Epoch: 10, Steps: 1103 | Train Loss: 0.7126167 Vali Loss: 0.8110697 Test Loss: 0.4028145
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_1240_Crossformer_custom_ftM_sl336_ll48_pl1240_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9300
test shape: (9300, 1240, 21) (9300, 1240, 21)
test shape: (9300, 1240, 21) (9300, 1240, 21)
mse:0.3890799880027771, mae:0.4058084785938263
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1688    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1688                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1688_Crossformer_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34864
val 3583
test 8852
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1688    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1688                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:3
>>>>>>>start training : long_term_forecast_weather_336_1688_Crossformer_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34864
val 3583
test 8852
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1688    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1688                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                7                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:7
>>>>>>>start training : long_term_forecast_weather_336_1688_Crossformer_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34864
val 3583
test 8852
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1688    Model:              Crossformer         

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1688                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           5                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                7                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:7
>>>>>>>start training : long_term_forecast_weather_336_1688_Crossformer_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34864
val 3583
test 8852
	iters: 100, epoch: 1 | loss: 0.8118854
	speed: 0.3625s/iter; left time: 7863.7892s
	iters: 200, epoch: 1 | loss: 0.7837535
	speed: 0.3647s/iter; left time: 7875.2229s
	iters: 300, epoch: 1 | loss: 0.7006623
	speed: 0.3674s/iter; left time: 7896.5738s
	iters: 400, epoch: 1 | loss: 0.6432492
	speed: 0.3688s/iter; left time: 7888.8746s
	iters: 500, epoch: 1 | loss: 0.7217821
	speed: 0.3693s/iter; left time: 7863.3279s
	iters: 600, epoch: 1 | loss: 0.8743568
	speed: 0.3699s/iter; left time: 7837.9914s
	iters: 700, epoch: 1 | loss: 0.8698179
	speed: 0.3715s/iter; left time: 7836.2750s
	iters: 800, epoch: 1 | loss: 0.7058524
	speed: 0.3716s/iter; left time: 7801.2270s
	iters: 900, epoch: 1 | loss: 0.6192104
	speed: 0.3712s/iter; left time: 7755.3553s
	iters: 1000, epoch: 1 | loss: 0.7624596
	speed: 0.3722s/iter; left time: 7738.1511s
	iters: 1100, epoch: 1 | loss: 0.9302142
	speed: 0.3728s/iter; left time: 7714.3048s
	iters: 1200, epoch: 1 | loss: 0.7587423
	speed: 0.3725s/iter; left time: 7670.5561s
	iters: 1300, epoch: 1 | loss: 0.6737822
	speed: 0.3732s/iter; left time: 7647.5894s
	iters: 1400, epoch: 1 | loss: 0.5911323
	speed: 0.3730s/iter; left time: 7605.3691s
	iters: 1500, epoch: 1 | loss: 0.7388222
	speed: 0.3738s/iter; left time: 7583.8650s
	iters: 1600, epoch: 1 | loss: 0.6930442
	speed: 0.3741s/iter; left time: 7553.2266s
	iters: 1700, epoch: 1 | loss: 0.9816095
	speed: 0.3727s/iter; left time: 7488.7430s
	iters: 1800, epoch: 1 | loss: 0.6469906
	speed: 0.3736s/iter; left time: 7467.9347s
	iters: 1900, epoch: 1 | loss: 0.9412588
	speed: 0.3729s/iter; left time: 7417.3802s
	iters: 2000, epoch: 1 | loss: 0.8062257
	speed: 0.3724s/iter; left time: 7370.9412s
	iters: 2100, epoch: 1 | loss: 0.8484394
	speed: 0.3725s/iter; left time: 7334.2673s
Epoch: 1 cost time: 808.7836277484894
Epoch: 1, Steps: 2179 | Train Loss: 0.8381741 Vali Loss: 0.8541220 Test Loss: 0.4334404
Validation loss decreased (inf --> 0.854122).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.9467852
	speed: 1.6738s/iter; left time: 32659.2749s
	iters: 200, epoch: 2 | loss: 0.8384163
	speed: 0.3592s/iter; left time: 6972.9685s
	iters: 300, epoch: 2 | loss: 0.7541277
	speed: 0.3586s/iter; left time: 6925.4194s
	iters: 400, epoch: 2 | loss: 0.7680546
	speed: 0.3574s/iter; left time: 6865.9863s
	iters: 500, epoch: 2 | loss: 0.5867609
	speed: 0.3567s/iter; left time: 6817.2053s
	iters: 600, epoch: 2 | loss: 0.6455511
	speed: 0.3565s/iter; left time: 6777.4356s
	iters: 700, epoch: 2 | loss: 0.6411712
	speed: 0.3559s/iter; left time: 6731.3922s
	iters: 800, epoch: 2 | loss: 0.6485988
	speed: 0.3560s/iter; left time: 6697.2837s
	iters: 900, epoch: 2 | loss: 0.8141803
	speed: 0.3557s/iter; left time: 6655.6027s
	iters: 1000, epoch: 2 | loss: 0.7947127
	speed: 0.3550s/iter; left time: 6607.1421s
	iters: 1100, epoch: 2 | loss: 0.8975055
	speed: 0.3540s/iter; left time: 6554.1597s
	iters: 1200, epoch: 2 | loss: 0.8952178
	speed: 0.3539s/iter; left time: 6515.7697s
	iters: 1300, epoch: 2 | loss: 0.7395445
	speed: 0.3547s/iter; left time: 6494.9153s
	iters: 1400, epoch: 2 | loss: 0.8340468
	speed: 0.3534s/iter; left time: 6436.5986s
	iters: 1500, epoch: 2 | loss: 0.6614772
	speed: 0.3531s/iter; left time: 6395.5276s
	iters: 1600, epoch: 2 | loss: 0.7955778
	speed: 0.3530s/iter; left time: 6358.1438s
	iters: 1700, epoch: 2 | loss: 0.7406923
	speed: 0.3527s/iter; left time: 6316.9482s
	iters: 1800, epoch: 2 | loss: 0.6862103
	speed: 0.3527s/iter; left time: 6281.8315s
	iters: 1900, epoch: 2 | loss: 0.6160635
	speed: 0.3516s/iter; left time: 6228.0487s
	iters: 2000, epoch: 2 | loss: 0.7313439
	speed: 0.3518s/iter; left time: 6195.4288s
	iters: 2100, epoch: 2 | loss: 0.9670385
	speed: 0.3516s/iter; left time: 6157.7293s
Epoch: 2 cost time: 773.0700764656067
Epoch: 2, Steps: 2179 | Train Loss: 0.7514765 Vali Loss: 0.8440996 Test Loss: 0.4134475
Validation loss decreased (0.854122 --> 0.844100).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7988703
	speed: 1.6200s/iter; left time: 28079.1556s
	iters: 200, epoch: 3 | loss: 0.7644175
	speed: 0.3562s/iter; left time: 6138.3222s
	iters: 300, epoch: 3 | loss: 0.6285427
	speed: 0.3555s/iter; left time: 6090.4244s
	iters: 400, epoch: 3 | loss: 0.5862427
	speed: 0.3559s/iter; left time: 6061.7673s
	iters: 500, epoch: 3 | loss: 0.7670609
	speed: 0.3560s/iter; left time: 6028.9108s
	iters: 600, epoch: 3 | loss: 1.0378362
	speed: 0.3558s/iter; left time: 5989.8757s
	iters: 700, epoch: 3 | loss: 0.6364718
	speed: 0.3560s/iter; left time: 5957.2805s
	iters: 800, epoch: 3 | loss: 0.7822165
	speed: 0.3562s/iter; left time: 5924.7976s
	iters: 900, epoch: 3 | loss: 0.7869097
	speed: 0.3563s/iter; left time: 5889.9858s
	iters: 1000, epoch: 3 | loss: 0.5735499
	speed: 0.3560s/iter; left time: 5849.3546s
	iters: 1100, epoch: 3 | loss: 0.6623546
	speed: 0.3558s/iter; left time: 5810.7697s
	iters: 1200, epoch: 3 | loss: 0.8490831
	speed: 0.3555s/iter; left time: 5771.1054s
	iters: 1300, epoch: 3 | loss: 0.8237347
	speed: 0.3559s/iter; left time: 5741.7735s
	iters: 1400, epoch: 3 | loss: 0.6646971
	speed: 0.3559s/iter; left time: 5706.4789s
	iters: 1500, epoch: 3 | loss: 0.7251905
	speed: 0.3552s/iter; left time: 5660.1793s
	iters: 1600, epoch: 3 | loss: 0.7069961
	speed: 0.3558s/iter; left time: 5633.2869s
	iters: 1700, epoch: 3 | loss: 0.6370600
	speed: 0.3555s/iter; left time: 5592.3523s
	iters: 1800, epoch: 3 | loss: 0.7671050
	speed: 0.3556s/iter; left time: 5559.4043s
	iters: 1900, epoch: 3 | loss: 0.7313986
	speed: 0.3552s/iter; left time: 5517.6980s
	iters: 2000, epoch: 3 | loss: 0.7607073
	speed: 0.3551s/iter; left time: 5480.4225s
	iters: 2100, epoch: 3 | loss: 0.7160549
	speed: 0.3545s/iter; left time: 5435.1073s
Epoch: 3 cost time: 775.020256280899
Epoch: 3, Steps: 2179 | Train Loss: 0.7421173 Vali Loss: 0.8558233 Test Loss: 0.4294404
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6525410
	speed: 1.6118s/iter; left time: 24424.5496s
	iters: 200, epoch: 4 | loss: 0.7832001
	speed: 0.3509s/iter; left time: 5282.9036s
	iters: 300, epoch: 4 | loss: 0.9936336
	speed: 0.3505s/iter; left time: 5241.1049s
	iters: 400, epoch: 4 | loss: 0.8204737
	speed: 0.3504s/iter; left time: 5204.6122s
	iters: 500, epoch: 4 | loss: 0.8151879
	speed: 0.3503s/iter; left time: 5167.6345s
	iters: 600, epoch: 4 | loss: 0.6495978
	speed: 0.3507s/iter; left time: 5138.9494s
	iters: 700, epoch: 4 | loss: 0.9737681
	speed: 0.3503s/iter; left time: 5098.5764s
	iters: 800, epoch: 4 | loss: 0.8038557
	speed: 0.3504s/iter; left time: 5064.3372s
	iters: 900, epoch: 4 | loss: 0.7952194
	speed: 0.3506s/iter; left time: 5032.6008s
	iters: 1000, epoch: 4 | loss: 0.5387063
	speed: 0.3507s/iter; left time: 4999.4883s
	iters: 1100, epoch: 4 | loss: 0.6441397
	speed: 0.3511s/iter; left time: 4970.0074s
	iters: 1200, epoch: 4 | loss: 0.8241121
	speed: 0.3505s/iter; left time: 4925.4737s
	iters: 1300, epoch: 4 | loss: 0.7178193
	speed: 0.3501s/iter; left time: 4885.1103s
	iters: 1400, epoch: 4 | loss: 0.7810861
	speed: 0.3501s/iter; left time: 4850.8626s
	iters: 1500, epoch: 4 | loss: 0.8638476
	speed: 0.3505s/iter; left time: 4820.3558s
	iters: 1600, epoch: 4 | loss: 0.8071774
	speed: 0.3508s/iter; left time: 4790.3649s
	iters: 1700, epoch: 4 | loss: 0.7038853
	speed: 0.3509s/iter; left time: 4756.3798s
	iters: 1800, epoch: 4 | loss: 0.7077996
	speed: 0.3507s/iter; left time: 4718.1199s
	iters: 1900, epoch: 4 | loss: 0.7324759
	speed: 0.3508s/iter; left time: 4684.3349s
	iters: 2000, epoch: 4 | loss: 0.6779838
	speed: 0.3503s/iter; left time: 4642.9764s
	iters: 2100, epoch: 4 | loss: 0.7345534
	speed: 0.3497s/iter; left time: 4600.0148s
Epoch: 4 cost time: 763.8591358661652
Epoch: 4, Steps: 2179 | Train Loss: 0.7364584 Vali Loss: 0.8508807 Test Loss: 0.4307840
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6217808
	speed: 1.6016s/iter; left time: 20780.2448s
	iters: 200, epoch: 5 | loss: 0.7385978
	speed: 0.3508s/iter; left time: 4517.0347s
	iters: 300, epoch: 5 | loss: 0.6037576
	speed: 0.3514s/iter; left time: 4488.6281s
	iters: 400, epoch: 5 | loss: 0.5792323
	speed: 0.3505s/iter; left time: 4442.3281s
	iters: 500, epoch: 5 | loss: 0.7973663
	speed: 0.3501s/iter; left time: 4402.2111s
	iters: 600, epoch: 5 | loss: 0.7990866
	speed: 0.3497s/iter; left time: 4362.9469s
	iters: 700, epoch: 5 | loss: 0.6998092
	speed: 0.3500s/iter; left time: 4331.4334s
	iters: 800, epoch: 5 | loss: 0.7891913
	speed: 0.3499s/iter; left time: 4295.2141s
	iters: 900, epoch: 5 | loss: 0.8284535
	speed: 0.3498s/iter; left time: 4259.1530s
	iters: 1000, epoch: 5 | loss: 0.6872702
	speed: 0.3496s/iter; left time: 4221.4383s
	iters: 1100, epoch: 5 | loss: 0.8853123
	speed: 0.3497s/iter; left time: 4188.0551s
	iters: 1200, epoch: 5 | loss: 0.7461474
	speed: 0.3495s/iter; left time: 4150.2389s
	iters: 1300, epoch: 5 | loss: 0.7894077
	speed: 0.3496s/iter; left time: 4116.7882s
	iters: 1400, epoch: 5 | loss: 0.9578519
	speed: 0.3497s/iter; left time: 4082.4505s
	iters: 1500, epoch: 5 | loss: 0.7070668
	speed: 0.3495s/iter; left time: 4045.9947s
	iters: 1600, epoch: 5 | loss: 0.8478084
	speed: 0.3492s/iter; left time: 4006.7449s
	iters: 1700, epoch: 5 | loss: 0.8299539
	speed: 0.3488s/iter; left time: 3967.1620s
	iters: 1800, epoch: 5 | loss: 0.6679418
	speed: 0.3488s/iter; left time: 3932.8812s
	iters: 1900, epoch: 5 | loss: 0.7825557
	speed: 0.3497s/iter; left time: 3908.2402s
	iters: 2000, epoch: 5 | loss: 0.7454230
	speed: 0.3496s/iter; left time: 3872.0934s
	iters: 2100, epoch: 5 | loss: 0.6429783
	speed: 0.3486s/iter; left time: 3826.2594s
Epoch: 5 cost time: 762.056184053421
Epoch: 5, Steps: 2179 | Train Loss: 0.7317585 Vali Loss: 0.8402701 Test Loss: 0.4279722
Validation loss decreased (0.844100 --> 0.840270).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.8510076
	speed: 1.6116s/iter; left time: 17398.5897s
	iters: 200, epoch: 6 | loss: 0.6760207
	speed: 0.3528s/iter; left time: 3773.1879s
	iters: 300, epoch: 6 | loss: 0.7396827
	speed: 0.3534s/iter; left time: 3744.5054s
	iters: 400, epoch: 6 | loss: 0.6284399
	speed: 0.3530s/iter; left time: 3704.8699s
	iters: 500, epoch: 6 | loss: 0.7032937
	speed: 0.3532s/iter; left time: 3672.0841s
	iters: 600, epoch: 6 | loss: 0.8647429
	speed: 0.3532s/iter; left time: 3636.3403s
	iters: 700, epoch: 6 | loss: 0.9006841
	speed: 0.3539s/iter; left time: 3608.3819s
	iters: 800, epoch: 6 | loss: 0.7100464
	speed: 0.3536s/iter; left time: 3570.1931s
	iters: 900, epoch: 6 | loss: 0.7329154
	speed: 0.3534s/iter; left time: 3533.0495s
	iters: 1000, epoch: 6 | loss: 0.7441438
	speed: 0.3537s/iter; left time: 3499.8385s
	iters: 1100, epoch: 6 | loss: 0.7203739
	speed: 0.3531s/iter; left time: 3459.4372s
	iters: 1200, epoch: 6 | loss: 0.5458365
	speed: 0.3534s/iter; left time: 3426.8766s
	iters: 1300, epoch: 6 | loss: 0.5980959
	speed: 0.3538s/iter; left time: 3395.4615s
	iters: 1400, epoch: 6 | loss: 0.7146675
	speed: 0.3537s/iter; left time: 3358.5485s
	iters: 1500, epoch: 6 | loss: 0.5941958
	speed: 0.3536s/iter; left time: 3321.9971s
	iters: 1600, epoch: 6 | loss: 0.8220733
	speed: 0.3532s/iter; left time: 3283.7989s
	iters: 1700, epoch: 6 | loss: 0.6128240
	speed: 0.3533s/iter; left time: 3248.9327s
	iters: 1800, epoch: 6 | loss: 0.6052542
	speed: 0.3526s/iter; left time: 3207.6514s
	iters: 1900, epoch: 6 | loss: 0.8684145
	speed: 0.3531s/iter; left time: 3176.6407s
	iters: 2000, epoch: 6 | loss: 0.6781945
	speed: 0.3533s/iter; left time: 3142.9361s
	iters: 2100, epoch: 6 | loss: 0.8682529
	speed: 0.3539s/iter; left time: 3113.1864s
Epoch: 6 cost time: 769.8787045478821
Epoch: 6, Steps: 2179 | Train Loss: 0.7271243 Vali Loss: 0.8525029 Test Loss: 0.4241725
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7161711
	speed: 1.6269s/iter; left time: 14019.3713s
	iters: 200, epoch: 7 | loss: 0.8606086
	speed: 0.3575s/iter; left time: 3044.7516s
	iters: 300, epoch: 7 | loss: 0.6618262
	speed: 0.3581s/iter; left time: 3014.4061s
	iters: 400, epoch: 7 | loss: 0.7190506
	speed: 0.3583s/iter; left time: 2980.1516s
	iters: 500, epoch: 7 | loss: 1.0329911
	speed: 0.3586s/iter; left time: 2946.6190s
	iters: 600, epoch: 7 | loss: 0.6905155
	speed: 0.3581s/iter; left time: 2906.6538s
	iters: 700, epoch: 7 | loss: 0.8234618
	speed: 0.3581s/iter; left time: 2871.1163s
	iters: 800, epoch: 7 | loss: 0.8558673
	speed: 0.3578s/iter; left time: 2832.3328s
	iters: 900, epoch: 7 | loss: 0.6302947
	speed: 0.3576s/iter; left time: 2795.6115s
	iters: 1000, epoch: 7 | loss: 0.5461994
	speed: 0.3577s/iter; left time: 2760.2506s
	iters: 1100, epoch: 7 | loss: 0.7409833
	speed: 0.3582s/iter; left time: 2728.1152s
	iters: 1200, epoch: 7 | loss: 0.7376193
	speed: 0.3581s/iter; left time: 2692.1676s
	iters: 1300, epoch: 7 | loss: 0.7915091
	speed: 0.3577s/iter; left time: 2653.1834s
	iters: 1400, epoch: 7 | loss: 0.7998625
	speed: 0.3570s/iter; left time: 2611.8483s
	iters: 1500, epoch: 7 | loss: 0.6093954
	speed: 0.3581s/iter; left time: 2584.1486s
	iters: 1600, epoch: 7 | loss: 0.8097826
	speed: 0.3584s/iter; left time: 2550.8134s
	iters: 1700, epoch: 7 | loss: 0.6966833
	speed: 0.3581s/iter; left time: 2512.8825s
	iters: 1800, epoch: 7 | loss: 0.7679223
	speed: 0.3576s/iter; left time: 2473.3202s
	iters: 1900, epoch: 7 | loss: 0.6161994
	speed: 0.3581s/iter; left time: 2441.4655s
	iters: 2000, epoch: 7 | loss: 0.5997018
	speed: 0.3584s/iter; left time: 2407.2801s
	iters: 2100, epoch: 7 | loss: 0.9738568
	speed: 0.3580s/iter; left time: 2368.9598s
Epoch: 7 cost time: 780.0400059223175
Epoch: 7, Steps: 2179 | Train Loss: 0.7239778 Vali Loss: 0.8657719 Test Loss: 0.4304299
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6962005
	speed: 1.6261s/iter; left time: 10468.5577s
	iters: 200, epoch: 8 | loss: 0.6854007
	speed: 0.3489s/iter; left time: 2211.1969s
	iters: 300, epoch: 8 | loss: 0.7514927
	speed: 0.3479s/iter; left time: 2170.0090s
	iters: 400, epoch: 8 | loss: 0.7768061
	speed: 0.3491s/iter; left time: 2142.9345s
	iters: 500, epoch: 8 | loss: 0.6235566
	speed: 0.3485s/iter; left time: 2104.0057s
	iters: 600, epoch: 8 | loss: 0.6638389
	speed: 0.3490s/iter; left time: 2072.1439s
	iters: 700, epoch: 8 | loss: 0.5769410
	speed: 0.3484s/iter; left time: 2034.0280s
	iters: 800, epoch: 8 | loss: 0.6203136
	speed: 0.3477s/iter; left time: 1995.1373s
	iters: 900, epoch: 8 | loss: 0.5443249
	speed: 0.3477s/iter; left time: 1960.0693s
	iters: 1000, epoch: 8 | loss: 0.6871974
	speed: 0.3476s/iter; left time: 1925.2297s
	iters: 1100, epoch: 8 | loss: 0.6840286
	speed: 0.3480s/iter; left time: 1892.6275s
	iters: 1200, epoch: 8 | loss: 0.6708563
	speed: 0.3482s/iter; left time: 1858.9325s
	iters: 1300, epoch: 8 | loss: 0.6311350
	speed: 0.3486s/iter; left time: 1825.7401s
	iters: 1400, epoch: 8 | loss: 0.5788678
	speed: 0.3488s/iter; left time: 1792.3125s
	iters: 1500, epoch: 8 | loss: 0.6622838
	speed: 0.3486s/iter; left time: 1756.2666s
	iters: 1600, epoch: 8 | loss: 0.7346097
	speed: 0.3489s/iter; left time: 1723.0367s
	iters: 1700, epoch: 8 | loss: 0.7717302
	speed: 0.3483s/iter; left time: 1685.2898s
	iters: 1800, epoch: 8 | loss: 0.7588974
	speed: 0.3494s/iter; left time: 1655.4336s
	iters: 1900, epoch: 8 | loss: 1.0107177
	speed: 0.3498s/iter; left time: 1622.2289s
	iters: 2000, epoch: 8 | loss: 0.8580071
	speed: 0.3499s/iter; left time: 1587.9950s
	iters: 2100, epoch: 8 | loss: 0.8215640
	speed: 0.3528s/iter; left time: 1565.5309s
Epoch: 8 cost time: 760.5024762153625
Epoch: 8, Steps: 2179 | Train Loss: 0.7222773 Vali Loss: 0.8666583 Test Loss: 0.4331669
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6330397
	speed: 1.6446s/iter; left time: 7004.1512s
	iters: 200, epoch: 9 | loss: 0.6958727
	speed: 0.3565s/iter; left time: 1482.8901s
	iters: 300, epoch: 9 | loss: 0.5634102
	speed: 0.3559s/iter; left time: 1444.7613s
	iters: 400, epoch: 9 | loss: 0.6404955
	speed: 0.3564s/iter; left time: 1411.0597s
	iters: 500, epoch: 9 | loss: 0.6071170
	speed: 0.3564s/iter; left time: 1375.1570s
	iters: 600, epoch: 9 | loss: 0.6457811
	speed: 0.3572s/iter; left time: 1342.6135s
	iters: 700, epoch: 9 | loss: 0.6515764
	speed: 0.3584s/iter; left time: 1311.5553s
	iters: 800, epoch: 9 | loss: 0.7307960
	speed: 0.3574s/iter; left time: 1271.9772s
	iters: 900, epoch: 9 | loss: 0.5957279
	speed: 0.3569s/iter; left time: 1234.5708s
	iters: 1000, epoch: 9 | loss: 0.5842932
	speed: 0.3566s/iter; left time: 1197.8970s
	iters: 1100, epoch: 9 | loss: 0.6851251
	speed: 0.3572s/iter; left time: 1164.1080s
	iters: 1200, epoch: 9 | loss: 0.7366282
	speed: 0.3575s/iter; left time: 1129.4663s
	iters: 1300, epoch: 9 | loss: 0.5625058
	speed: 0.3578s/iter; left time: 1094.4074s
	iters: 1400, epoch: 9 | loss: 0.5973103
	speed: 0.3568s/iter; left time: 1055.6668s
	iters: 1500, epoch: 9 | loss: 0.7175962
	speed: 0.3569s/iter; left time: 1020.2511s
	iters: 1600, epoch: 9 | loss: 0.9069237
	speed: 0.3576s/iter; left time: 986.6642s
	iters: 1700, epoch: 9 | loss: 0.6909187
	speed: 0.3585s/iter; left time: 953.3531s
	iters: 1800, epoch: 9 | loss: 0.7804871
	speed: 0.3590s/iter; left time: 918.7904s
	iters: 1900, epoch: 9 | loss: 0.5900050
	speed: 0.3614s/iter; left time: 888.7637s
	iters: 2000, epoch: 9 | loss: 0.7586940
	speed: 0.3605s/iter; left time: 850.3626s
	iters: 2100, epoch: 9 | loss: 0.7208456
	speed: 0.3619s/iter; left time: 817.5659s
Epoch: 9 cost time: 779.7357227802277
Epoch: 9, Steps: 2179 | Train Loss: 0.7213123 Vali Loss: 0.8639541 Test Loss: 0.4317791
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7651296
	speed: 1.6860s/iter; left time: 3506.9537s
	iters: 200, epoch: 10 | loss: 0.8524283
	speed: 0.3622s/iter; left time: 717.1219s
	iters: 300, epoch: 10 | loss: 0.7492341
	speed: 0.3627s/iter; left time: 681.9412s
	iters: 400, epoch: 10 | loss: 0.7498803
	speed: 0.3583s/iter; left time: 637.7423s
	iters: 500, epoch: 10 | loss: 0.6581078
	speed: 0.3602s/iter; left time: 605.1313s
	iters: 600, epoch: 10 | loss: 0.7745461
	speed: 0.3611s/iter; left time: 570.5134s
	iters: 700, epoch: 10 | loss: 0.6415508
	speed: 0.3597s/iter; left time: 532.3852s
	iters: 800, epoch: 10 | loss: 0.9888251
	speed: 0.3639s/iter; left time: 502.1256s
	iters: 900, epoch: 10 | loss: 0.8312399
	speed: 0.3622s/iter; left time: 463.5966s
	iters: 1000, epoch: 10 | loss: 0.6266366
	speed: 0.3610s/iter; left time: 425.9929s
	iters: 1100, epoch: 10 | loss: 0.6748642
	speed: 0.3598s/iter; left time: 388.5898s
	iters: 1200, epoch: 10 | loss: 0.6825787
	speed: 0.3589s/iter; left time: 351.7329s
	iters: 1300, epoch: 10 | loss: 0.6746818
	speed: 0.3591s/iter; left time: 316.0223s
	iters: 1400, epoch: 10 | loss: 0.7754490
	speed: 0.3594s/iter; left time: 280.3627s
	iters: 1500, epoch: 10 | loss: 0.6693343
	speed: 0.3639s/iter; left time: 247.4345s
	iters: 1600, epoch: 10 | loss: 0.6517600
	speed: 0.3612s/iter; left time: 209.4953s
	iters: 1700, epoch: 10 | loss: 0.7608361
	speed: 0.3601s/iter; left time: 172.8517s
	iters: 1800, epoch: 10 | loss: 0.6657734
	speed: 0.3601s/iter; left time: 136.8352s
	iters: 1900, epoch: 10 | loss: 0.7955776
	speed: 0.3642s/iter; left time: 101.9869s
	iters: 2000, epoch: 10 | loss: 0.8625422
	speed: 0.3641s/iter; left time: 65.5409s
	iters: 2100, epoch: 10 | loss: 0.6311276
	speed: 0.3654s/iter; left time: 29.2309s
Epoch: 10 cost time: 787.335042476654
Epoch: 10, Steps: 2179 | Train Loss: 0.7207165 Vali Loss: 0.8615195 Test Loss: 0.4295044
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_1688_Crossformer_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8852
test shape: (8852, 1688, 21) (8852, 1688, 21)
test shape: (8852, 1688, 21) (8852, 1688, 21)
mse:0.42797255516052246, mae:0.43918606638908386
