Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_96      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 8.9324818
	speed: 0.1056s/iter; left time: 590.5542s
	iters: 200, epoch: 1 | loss: 9.3639507
	speed: 0.0963s/iter; left time: 528.9867s
	iters: 300, epoch: 1 | loss: 1.7978753
	speed: 0.1049s/iter; left time: 565.4178s
	iters: 400, epoch: 1 | loss: 1.1498772
	speed: 0.1675s/iter; left time: 886.3480s
	iters: 500, epoch: 1 | loss: 0.7745432
	speed: 0.1653s/iter; left time: 857.9554s
Epoch: 1 cost time: 75.66893267631531
Epoch: 1, Steps: 569 | Train Loss: 4.1605421 Vali Loss: 0.9908974 Test Loss: 0.3637650
Validation loss decreased (inf --> 0.990897).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5003380
	speed: 0.6951s/iter; left time: 3490.5955s
	iters: 200, epoch: 2 | loss: 0.6219484
	speed: 0.1587s/iter; left time: 780.9973s
	iters: 300, epoch: 2 | loss: 0.9319261
	speed: 0.1643s/iter; left time: 792.2744s
	iters: 400, epoch: 2 | loss: 0.5477455
	speed: 0.1636s/iter; left time: 772.6467s
	iters: 500, epoch: 2 | loss: 0.5227908
	speed: 0.1651s/iter; left time: 762.9037s
Epoch: 2 cost time: 94.73464894294739
Epoch: 2, Steps: 569 | Train Loss: 0.6506920 Vali Loss: 0.6966456 Test Loss: 0.2639447
Validation loss decreased (0.990897 --> 0.696646).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4343393
	speed: 0.7050s/iter; left time: 3139.4559s
	iters: 200, epoch: 3 | loss: 0.4151827
	speed: 0.1741s/iter; left time: 758.0353s
	iters: 300, epoch: 3 | loss: 0.4557380
	speed: 0.1803s/iter; left time: 766.7420s
	iters: 400, epoch: 3 | loss: 0.3723637
	speed: 0.1641s/iter; left time: 681.3773s
	iters: 500, epoch: 3 | loss: 0.5368272
	speed: 0.1636s/iter; left time: 663.0697s
Epoch: 3 cost time: 95.46891832351685
Epoch: 3, Steps: 569 | Train Loss: 0.5209481 Vali Loss: 0.5218353 Test Loss: 0.2029839
Validation loss decreased (0.696646 --> 0.521835).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7161883
	speed: 0.7496s/iter; left time: 2911.5324s
	iters: 200, epoch: 4 | loss: 0.4046946
	speed: 0.1639s/iter; left time: 620.0452s
	iters: 300, epoch: 4 | loss: 0.5773038
	speed: 0.1803s/iter; left time: 664.3293s
	iters: 400, epoch: 4 | loss: 0.3977302
	speed: 0.1744s/iter; left time: 625.0720s
	iters: 500, epoch: 4 | loss: 0.7130379
	speed: 0.1676s/iter; left time: 583.8577s
Epoch: 4 cost time: 97.67444324493408
Epoch: 4, Steps: 569 | Train Loss: 0.4914766 Vali Loss: 0.4418571 Test Loss: 0.1749971
Validation loss decreased (0.521835 --> 0.441857).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2963892
	speed: 0.7718s/iter; left time: 2558.5358s
	iters: 200, epoch: 5 | loss: 0.4088776
	speed: 0.1701s/iter; left time: 546.8995s
	iters: 300, epoch: 5 | loss: 0.4712175
	speed: 0.1854s/iter; left time: 577.6246s
	iters: 400, epoch: 5 | loss: 0.4891962
	speed: 0.1758s/iter; left time: 529.9551s
	iters: 500, epoch: 5 | loss: 1.1997731
	speed: 0.1603s/iter; left time: 467.2678s
Epoch: 5 cost time: 97.68294286727905
Epoch: 5, Steps: 569 | Train Loss: 0.4775274 Vali Loss: 0.4218930 Test Loss: 0.1674373
Validation loss decreased (0.441857 --> 0.421893).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3960161
	speed: 0.7045s/iter; left time: 1934.6392s
	iters: 200, epoch: 6 | loss: 0.4298505
	speed: 0.1678s/iter; left time: 443.8796s
	iters: 300, epoch: 6 | loss: 0.5358408
	speed: 0.1588s/iter; left time: 404.2929s
	iters: 400, epoch: 6 | loss: 0.3746511
	speed: 0.1721s/iter; left time: 420.9472s
	iters: 500, epoch: 6 | loss: 0.3822613
	speed: 0.1729s/iter; left time: 405.5250s
Epoch: 6 cost time: 95.13433074951172
Epoch: 6, Steps: 569 | Train Loss: 0.4717857 Vali Loss: 0.4071596 Test Loss: 0.1627817
Validation loss decreased (0.421893 --> 0.407160).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3567877
	speed: 0.7117s/iter; left time: 1549.4065s
	iters: 200, epoch: 7 | loss: 0.4467216
	speed: 0.1716s/iter; left time: 356.3429s
	iters: 300, epoch: 7 | loss: 0.3657022
	speed: 0.1678s/iter; left time: 331.6764s
	iters: 400, epoch: 7 | loss: 0.3790008
	speed: 0.1704s/iter; left time: 319.8222s
	iters: 500, epoch: 7 | loss: 0.3851194
	speed: 0.1675s/iter; left time: 297.6182s
Epoch: 7 cost time: 96.03414011001587
Epoch: 7, Steps: 569 | Train Loss: 0.4673923 Vali Loss: 0.4042815 Test Loss: 0.1605847
Validation loss decreased (0.407160 --> 0.404281).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3308674
	speed: 0.6984s/iter; left time: 1122.9538s
	iters: 200, epoch: 8 | loss: 0.3879492
	speed: 0.1635s/iter; left time: 246.5458s
	iters: 300, epoch: 8 | loss: 0.4584186
	speed: 0.1585s/iter; left time: 223.2068s
	iters: 400, epoch: 8 | loss: 0.4305101
	speed: 0.1663s/iter; left time: 217.5527s
	iters: 500, epoch: 8 | loss: 0.8694176
	speed: 0.1683s/iter; left time: 203.3282s
Epoch: 8 cost time: 94.08539462089539
Epoch: 8, Steps: 569 | Train Loss: 0.4656443 Vali Loss: 0.4050713 Test Loss: 0.1612208
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4575294
	speed: 0.6941s/iter; left time: 721.1632s
	iters: 200, epoch: 9 | loss: 0.5320234
	speed: 0.1719s/iter; left time: 161.4420s
	iters: 300, epoch: 9 | loss: 0.3857175
	speed: 0.1759s/iter; left time: 147.5445s
	iters: 400, epoch: 9 | loss: 0.2846799
	speed: 0.1603s/iter; left time: 118.4525s
	iters: 500, epoch: 9 | loss: 0.3085690
	speed: 0.1642s/iter; left time: 104.8951s
Epoch: 9 cost time: 95.62572741508484
Epoch: 9, Steps: 569 | Train Loss: 0.4642720 Vali Loss: 0.4025852 Test Loss: 0.1602287
Validation loss decreased (0.404281 --> 0.402585).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.8066415
	speed: 0.7348s/iter; left time: 345.3555s
	iters: 200, epoch: 10 | loss: 0.4541981
	speed: 0.1698s/iter; left time: 62.8212s
	iters: 300, epoch: 10 | loss: 0.4455352
	speed: 0.1693s/iter; left time: 45.7110s
	iters: 400, epoch: 10 | loss: 1.2651446
	speed: 0.1627s/iter; left time: 27.6515s
	iters: 500, epoch: 10 | loss: 0.6856087
	speed: 0.1737s/iter; left time: 12.1557s
Epoch: 10 cost time: 97.35160183906555
Epoch: 10, Steps: 569 | Train Loss: 0.4635056 Vali Loss: 0.4026769 Test Loss: 0.1594988
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.16022871434688568, mae:0.21151460707187653
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_192     Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_192_PatchTST_custom_ftM_sl336_ll48_pl192_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 5.4161701
	speed: 0.1648s/iter; left time: 919.9989s
	iters: 200, epoch: 1 | loss: 2.6099231
	speed: 0.1663s/iter; left time: 911.5974s
	iters: 300, epoch: 1 | loss: 4.3485556
	speed: 0.1721s/iter; left time: 925.9541s
	iters: 400, epoch: 1 | loss: 1.2996795
	speed: 0.1805s/iter; left time: 953.1768s
	iters: 500, epoch: 1 | loss: 1.2095963
	speed: 0.1684s/iter; left time: 872.2625s
Epoch: 1 cost time: 97.81942081451416
Epoch: 1, Steps: 568 | Train Loss: 3.4439656 Vali Loss: 0.8094696 Test Loss: 0.3192206
Validation loss decreased (inf --> 0.809470).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.1697478
	speed: 0.7391s/iter; left time: 3705.0878s
	iters: 200, epoch: 2 | loss: 0.8425345
	speed: 0.1667s/iter; left time: 819.0649s
	iters: 300, epoch: 2 | loss: 0.9269111
	speed: 0.1800s/iter; left time: 866.2234s
	iters: 400, epoch: 2 | loss: 0.9155722
	speed: 0.1629s/iter; left time: 767.7855s
	iters: 500, epoch: 2 | loss: 0.5864411
	speed: 0.1705s/iter; left time: 786.4868s
Epoch: 2 cost time: 96.3219985961914
Epoch: 2, Steps: 568 | Train Loss: 0.8689630 Vali Loss: 0.7499905 Test Loss: 0.2907113
Validation loss decreased (0.809470 --> 0.749991).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6081657
	speed: 0.7211s/iter; left time: 3205.1036s
	iters: 200, epoch: 3 | loss: 0.6818093
	speed: 0.1674s/iter; left time: 727.4292s
	iters: 300, epoch: 3 | loss: 0.8039795
	speed: 0.1646s/iter; left time: 698.6068s
	iters: 400, epoch: 3 | loss: 0.4855622
	speed: 0.1768s/iter; left time: 732.6738s
	iters: 500, epoch: 3 | loss: 0.9433528
	speed: 0.1658s/iter; left time: 670.8600s
Epoch: 3 cost time: 95.93208193778992
Epoch: 3, Steps: 568 | Train Loss: 0.5967976 Vali Loss: 0.5800649 Test Loss: 0.2463677
Validation loss decreased (0.749991 --> 0.580065).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5249385
	speed: 0.7187s/iter; left time: 2786.3059s
	iters: 200, epoch: 4 | loss: 0.5791419
	speed: 0.1697s/iter; left time: 641.0412s
	iters: 300, epoch: 4 | loss: 0.4304985
	speed: 0.1661s/iter; left time: 610.7387s
	iters: 400, epoch: 4 | loss: 0.4360959
	speed: 0.1724s/iter; left time: 616.6551s
	iters: 500, epoch: 4 | loss: 0.4879477
	speed: 0.1706s/iter; left time: 593.2076s
Epoch: 4 cost time: 95.54480123519897
Epoch: 4, Steps: 568 | Train Loss: 0.5478157 Vali Loss: 0.5375999 Test Loss: 0.2237959
Validation loss decreased (0.580065 --> 0.537600).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4672849
	speed: 0.6559s/iter; left time: 2170.2466s
	iters: 200, epoch: 5 | loss: 0.3949926
	speed: 0.1715s/iter; left time: 550.4707s
	iters: 300, epoch: 5 | loss: 0.4238186
	speed: 0.1637s/iter; left time: 509.0885s
	iters: 400, epoch: 5 | loss: 0.6490493
	speed: 0.1715s/iter; left time: 516.1125s
	iters: 500, epoch: 5 | loss: 0.4127991
	speed: 0.1769s/iter; left time: 514.4976s
Epoch: 5 cost time: 95.66532444953918
Epoch: 5, Steps: 568 | Train Loss: 0.5291589 Vali Loss: 0.4973159 Test Loss: 0.2102799
Validation loss decreased (0.537600 --> 0.497316).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5002808
	speed: 0.7353s/iter; left time: 2015.4711s
	iters: 200, epoch: 6 | loss: 0.4438830
	speed: 0.1662s/iter; left time: 438.9731s
	iters: 300, epoch: 6 | loss: 0.3683966
	speed: 0.1574s/iter; left time: 399.9752s
	iters: 400, epoch: 6 | loss: 0.4643283
	speed: 0.1698s/iter; left time: 414.5283s
	iters: 500, epoch: 6 | loss: 0.4193943
	speed: 0.1679s/iter; left time: 393.0179s
Epoch: 6 cost time: 94.40949630737305
Epoch: 6, Steps: 568 | Train Loss: 0.5207584 Vali Loss: 0.4828035 Test Loss: 0.2049815
Validation loss decreased (0.497316 --> 0.482804).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3876545
	speed: 0.7529s/iter; left time: 1636.1559s
	iters: 200, epoch: 7 | loss: 0.4399585
	speed: 0.1628s/iter; left time: 337.5076s
	iters: 300, epoch: 7 | loss: 0.4615066
	speed: 0.1736s/iter; left time: 342.4148s
	iters: 400, epoch: 7 | loss: 0.4199014
	speed: 0.1733s/iter; left time: 324.6551s
	iters: 500, epoch: 7 | loss: 0.4190996
	speed: 0.1548s/iter; left time: 274.5238s
Epoch: 7 cost time: 95.42533946037292
Epoch: 7, Steps: 568 | Train Loss: 0.5163219 Vali Loss: 0.4767106 Test Loss: 0.2038768
Validation loss decreased (0.482804 --> 0.476711).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3636664
	speed: 0.6919s/iter; left time: 1110.4299s
	iters: 200, epoch: 8 | loss: 0.4376051
	speed: 0.1629s/iter; left time: 245.1261s
	iters: 300, epoch: 8 | loss: 0.7343937
	speed: 0.1727s/iter; left time: 242.6234s
	iters: 400, epoch: 8 | loss: 0.6862786
	speed: 0.1720s/iter; left time: 224.4957s
	iters: 500, epoch: 8 | loss: 0.4087745
	speed: 0.1663s/iter; left time: 200.4087s
Epoch: 8 cost time: 95.36423540115356
Epoch: 8, Steps: 568 | Train Loss: 0.5141408 Vali Loss: 0.4762711 Test Loss: 0.2030752
Validation loss decreased (0.476711 --> 0.476271).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4517189
	speed: 0.7499s/iter; left time: 777.6718s
	iters: 200, epoch: 9 | loss: 0.4605490
	speed: 0.1625s/iter; left time: 152.2248s
	iters: 300, epoch: 9 | loss: 0.4336541
	speed: 0.1766s/iter; left time: 147.7858s
	iters: 400, epoch: 9 | loss: 0.4848208
	speed: 0.1573s/iter; left time: 115.9354s
	iters: 500, epoch: 9 | loss: 0.4361736
	speed: 0.1692s/iter; left time: 107.7502s
Epoch: 9 cost time: 95.56618809700012
Epoch: 9, Steps: 568 | Train Loss: 0.5126385 Vali Loss: 0.4760075 Test Loss: 0.2026346
Validation loss decreased (0.476271 --> 0.476007).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6688756
	speed: 0.7131s/iter; left time: 334.4449s
	iters: 200, epoch: 10 | loss: 0.3209860
	speed: 0.1688s/iter; left time: 62.2747s
	iters: 300, epoch: 10 | loss: 0.5174420
	speed: 0.1680s/iter; left time: 45.1841s
	iters: 400, epoch: 10 | loss: 0.3357674
	speed: 0.1635s/iter; left time: 27.6317s
	iters: 500, epoch: 10 | loss: 0.4286594
	speed: 0.1640s/iter; left time: 11.3130s
Epoch: 10 cost time: 95.58412432670593
Epoch: 10, Steps: 568 | Train Loss: 0.5117002 Vali Loss: 0.4764872 Test Loss: 0.2027014
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_192_PatchTST_custom_ftM_sl336_ll48_pl192_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.20263457298278809, mae:0.2519446015357971
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_336     Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_336_PatchTST_custom_ftM_sl336_ll48_pl336_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 5.9405489
	speed: 0.2115s/iter; left time: 1174.0841s
	iters: 200, epoch: 1 | loss: 5.6184821
	speed: 0.2103s/iter; left time: 1146.4602s
	iters: 300, epoch: 1 | loss: 2.9317110
	speed: 0.2116s/iter; left time: 1132.3735s
	iters: 400, epoch: 1 | loss: 0.9213391
	speed: 0.1971s/iter; left time: 1034.9131s
	iters: 500, epoch: 1 | loss: 0.8553548
	speed: 0.2019s/iter; left time: 1040.0191s
Epoch: 1 cost time: 117.60755443572998
Epoch: 1, Steps: 565 | Train Loss: 4.0363031 Vali Loss: 1.0759593 Test Loss: 0.4414780
Validation loss decreased (inf --> 1.075959).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7028352
	speed: 0.7914s/iter; left time: 3945.7734s
	iters: 200, epoch: 2 | loss: 0.6893230
	speed: 0.2160s/iter; left time: 1055.2775s
	iters: 300, epoch: 2 | loss: 0.7956995
	speed: 0.2089s/iter; left time: 999.7057s
	iters: 400, epoch: 2 | loss: 0.6378232
	speed: 0.2150s/iter; left time: 1007.2868s
	iters: 500, epoch: 2 | loss: 0.5830196
	speed: 0.2011s/iter; left time: 922.3756s
Epoch: 2 cost time: 119.47252130508423
Epoch: 2, Steps: 565 | Train Loss: 0.6787296 Vali Loss: 1.0722284 Test Loss: 0.4278718
Validation loss decreased (1.075959 --> 1.072228).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5657941
	speed: 0.8473s/iter; left time: 3746.0070s
	iters: 200, epoch: 3 | loss: 0.5427234
	speed: 0.2128s/iter; left time: 919.6437s
	iters: 300, epoch: 3 | loss: 0.5468603
	speed: 0.2152s/iter; left time: 908.2868s
	iters: 400, epoch: 3 | loss: 0.4737341
	speed: 0.2094s/iter; left time: 862.9576s
	iters: 500, epoch: 3 | loss: 0.5372518
	speed: 0.2066s/iter; left time: 830.9348s
Epoch: 3 cost time: 118.90703558921814
Epoch: 3, Steps: 565 | Train Loss: 0.6031571 Vali Loss: 0.6892652 Test Loss: 0.3028508
Validation loss decreased (1.072228 --> 0.689265).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4802063
	speed: 0.8610s/iter; left time: 3320.1592s
	iters: 200, epoch: 4 | loss: 0.6729601
	speed: 0.2161s/iter; left time: 811.6789s
	iters: 300, epoch: 4 | loss: 0.6274302
	speed: 0.2080s/iter; left time: 760.4704s
	iters: 400, epoch: 4 | loss: 0.7074642
	speed: 0.2131s/iter; left time: 757.7761s
	iters: 500, epoch: 4 | loss: 0.5005665
	speed: 0.2055s/iter; left time: 710.1728s
Epoch: 4 cost time: 118.0807945728302
Epoch: 4, Steps: 565 | Train Loss: 0.5854912 Vali Loss: 0.6715754 Test Loss: 0.2929686
Validation loss decreased (0.689265 --> 0.671575).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6561050
	speed: 0.9285s/iter; left time: 3055.7398s
	iters: 200, epoch: 5 | loss: 0.6352168
	speed: 0.2211s/iter; left time: 705.6109s
	iters: 300, epoch: 5 | loss: 0.4550573
	speed: 0.2264s/iter; left time: 699.7651s
	iters: 400, epoch: 5 | loss: 0.4654505
	speed: 0.2021s/iter; left time: 604.4136s
	iters: 500, epoch: 5 | loss: 0.4875903
	speed: 0.2001s/iter; left time: 578.4920s
Epoch: 5 cost time: 120.00426173210144
Epoch: 5, Steps: 565 | Train Loss: 0.5771950 Vali Loss: 0.5911658 Test Loss: 0.2674110
Validation loss decreased (0.671575 --> 0.591166).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5316823
	speed: 0.8734s/iter; left time: 2380.8850s
	iters: 200, epoch: 6 | loss: 0.4725605
	speed: 0.2144s/iter; left time: 562.9647s
	iters: 300, epoch: 6 | loss: 0.5336592
	speed: 0.2038s/iter; left time: 514.6988s
	iters: 400, epoch: 6 | loss: 0.5363096
	speed: 0.2151s/iter; left time: 521.9023s
	iters: 500, epoch: 6 | loss: 0.4555511
	speed: 0.2134s/iter; left time: 496.4434s
Epoch: 6 cost time: 121.58499002456665
Epoch: 6, Steps: 565 | Train Loss: 0.5728116 Vali Loss: 0.5768466 Test Loss: 0.2618935
Validation loss decreased (0.591166 --> 0.576847).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5080159
	speed: 0.8423s/iter; left time: 1820.2501s
	iters: 200, epoch: 7 | loss: 0.6286953
	speed: 0.2079s/iter; left time: 428.4190s
	iters: 300, epoch: 7 | loss: 0.6457241
	speed: 0.2137s/iter; left time: 419.0813s
	iters: 400, epoch: 7 | loss: 0.4635809
	speed: 0.2091s/iter; left time: 389.1977s
	iters: 500, epoch: 7 | loss: 0.5554412
	speed: 0.2053s/iter; left time: 361.5754s
Epoch: 7 cost time: 119.57684564590454
Epoch: 7, Steps: 565 | Train Loss: 0.5701641 Vali Loss: 0.5762861 Test Loss: 0.2601330
Validation loss decreased (0.576847 --> 0.576286).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4520375
	speed: 0.8973s/iter; left time: 1432.1283s
	iters: 200, epoch: 8 | loss: 0.7327270
	speed: 0.1956s/iter; left time: 292.5875s
	iters: 300, epoch: 8 | loss: 0.4402646
	speed: 0.2072s/iter; left time: 289.2460s
	iters: 400, epoch: 8 | loss: 0.5992578
	speed: 0.2209s/iter; left time: 286.2308s
	iters: 500, epoch: 8 | loss: 0.7629591
	speed: 0.2145s/iter; left time: 256.5686s
Epoch: 8 cost time: 119.32451128959656
Epoch: 8, Steps: 565 | Train Loss: 0.5689658 Vali Loss: 0.5659801 Test Loss: 0.2576606
Validation loss decreased (0.576286 --> 0.565980).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4863531
	speed: 0.8587s/iter; left time: 885.3152s
	iters: 200, epoch: 9 | loss: 0.6317073
	speed: 0.2205s/iter; left time: 205.2944s
	iters: 300, epoch: 9 | loss: 0.6998595
	speed: 0.2075s/iter; left time: 172.4536s
	iters: 400, epoch: 9 | loss: 0.4750982
	speed: 0.2092s/iter; left time: 152.9553s
	iters: 500, epoch: 9 | loss: 0.4743583
	speed: 0.2051s/iter; left time: 129.4431s
Epoch: 9 cost time: 121.6068069934845
Epoch: 9, Steps: 565 | Train Loss: 0.5675169 Vali Loss: 0.5674195 Test Loss: 0.2574593
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6808574
	speed: 0.8478s/iter; left time: 395.0637s
	iters: 200, epoch: 10 | loss: 0.6143479
	speed: 0.2281s/iter; left time: 83.4880s
	iters: 300, epoch: 10 | loss: 0.7528972
	speed: 0.2165s/iter; left time: 57.5890s
	iters: 400, epoch: 10 | loss: 0.5212699
	speed: 0.2118s/iter; left time: 35.1528s
	iters: 500, epoch: 10 | loss: 0.5054705
	speed: 0.2039s/iter; left time: 13.4571s
Epoch: 10 cost time: 121.72273850440979
Epoch: 10, Steps: 565 | Train Loss: 0.5674851 Vali Loss: 0.5650946 Test Loss: 0.2570981
Validation loss decreased (0.565980 --> 0.565095).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_336_PatchTST_custom_ftM_sl336_ll48_pl336_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2570981979370117, mae:0.29201558232307434
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_720     Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 5.7683568
	speed: 0.1578s/iter; left time: 866.7391s
	iters: 200, epoch: 1 | loss: 7.9362369
	speed: 0.2220s/iter; left time: 1196.8431s
	iters: 300, epoch: 1 | loss: 3.2596965
	speed: 0.2217s/iter; left time: 1173.2640s
	iters: 400, epoch: 1 | loss: 2.4940052
	speed: 0.2285s/iter; left time: 1186.0712s
	iters: 500, epoch: 1 | loss: 1.5424724
	speed: 0.2185s/iter; left time: 1112.4634s
Epoch: 1 cost time: 116.77029657363892
Epoch: 1, Steps: 559 | Train Loss: 4.6251666 Vali Loss: 23.5654136 Test Loss: 7.7286351
Validation loss decreased (inf --> 23.565414).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7082350
	speed: 0.8202s/iter; left time: 4045.3247s
	iters: 200, epoch: 2 | loss: 0.6827931
	speed: 0.2047s/iter; left time: 989.2738s
	iters: 300, epoch: 2 | loss: 0.8315277
	speed: 0.2245s/iter; left time: 1062.2188s
	iters: 400, epoch: 2 | loss: 0.6555498
	speed: 0.2178s/iter; left time: 1008.9380s
	iters: 500, epoch: 2 | loss: 0.6599873
	speed: 0.2077s/iter; left time: 941.5043s
Epoch: 2 cost time: 120.3850474357605
Epoch: 2, Steps: 559 | Train Loss: 0.7606764 Vali Loss: 1.0477587 Test Loss: 0.4581047
Validation loss decreased (23.565414 --> 1.047759).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6698149
	speed: 0.9219s/iter; left time: 4031.3122s
	iters: 200, epoch: 3 | loss: 0.6108947
	speed: 0.2351s/iter; left time: 1004.5584s
	iters: 300, epoch: 3 | loss: 0.6513200
	speed: 0.2149s/iter; left time: 896.8499s
	iters: 400, epoch: 3 | loss: 0.6184087
	speed: 0.2125s/iter; left time: 865.4391s
	iters: 500, epoch: 3 | loss: 0.5294967
	speed: 0.2205s/iter; left time: 876.1026s
Epoch: 3 cost time: 123.34960651397705
Epoch: 3, Steps: 559 | Train Loss: 0.6737913 Vali Loss: 0.7482929 Test Loss: 0.3569162
Validation loss decreased (1.047759 --> 0.748293).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5562112
	speed: 0.8799s/iter; left time: 3356.0312s
	iters: 200, epoch: 4 | loss: 0.5293037
	speed: 0.2285s/iter; left time: 848.8202s
	iters: 300, epoch: 4 | loss: 0.7239071
	speed: 0.2119s/iter; left time: 765.7611s
	iters: 400, epoch: 4 | loss: 0.6592169
	speed: 0.2334s/iter; left time: 820.1281s
	iters: 500, epoch: 4 | loss: 0.7907951
	speed: 0.2177s/iter; left time: 743.3811s
Epoch: 4 cost time: 124.8004367351532
Epoch: 4, Steps: 559 | Train Loss: 0.6579079 Vali Loss: 0.7351284 Test Loss: 0.3526733
Validation loss decreased (0.748293 --> 0.735128).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7239130
	speed: 0.8923s/iter; left time: 2904.5368s
	iters: 200, epoch: 5 | loss: 0.6365581
	speed: 0.2196s/iter; left time: 692.8173s
	iters: 300, epoch: 5 | loss: 0.8199291
	speed: 0.2192s/iter; left time: 669.5038s
	iters: 400, epoch: 5 | loss: 0.6590272
	speed: 0.2376s/iter; left time: 702.0444s
	iters: 500, epoch: 5 | loss: 0.6142339
	speed: 0.2106s/iter; left time: 601.2385s
Epoch: 5 cost time: 124.91105675697327
Epoch: 5, Steps: 559 | Train Loss: 0.6505714 Vali Loss: 0.7099993 Test Loss: 0.3433293
Validation loss decreased (0.735128 --> 0.709999).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6034544
	speed: 0.8536s/iter; left time: 2301.2474s
	iters: 200, epoch: 6 | loss: 0.7807007
	speed: 0.2043s/iter; left time: 530.4748s
	iters: 300, epoch: 6 | loss: 0.5695975
	speed: 0.2260s/iter; left time: 564.0936s
	iters: 400, epoch: 6 | loss: 0.7033398
	speed: 0.2357s/iter; left time: 564.6334s
	iters: 500, epoch: 6 | loss: 0.5691519
	speed: 0.2197s/iter; left time: 504.3946s
Epoch: 6 cost time: 125.78977560997009
Epoch: 6, Steps: 559 | Train Loss: 0.6464399 Vali Loss: 0.6984616 Test Loss: 0.3402657
Validation loss decreased (0.709999 --> 0.698462).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.6203572
	speed: 0.9165s/iter; left time: 1958.4566s
	iters: 200, epoch: 7 | loss: 0.6975949
	speed: 0.2385s/iter; left time: 485.8197s
	iters: 300, epoch: 7 | loss: 0.7050204
	speed: 0.2062s/iter; left time: 399.3435s
	iters: 400, epoch: 7 | loss: 0.7787821
	speed: 0.2201s/iter; left time: 404.3862s
	iters: 500, epoch: 7 | loss: 0.6029649
	speed: 0.2283s/iter; left time: 396.6014s
Epoch: 7 cost time: 125.40946435928345
Epoch: 7, Steps: 559 | Train Loss: 0.6442486 Vali Loss: 0.6889190 Test Loss: 0.3363479
Validation loss decreased (0.698462 --> 0.688919).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5534550
	speed: 0.9032s/iter; left time: 1425.2772s
	iters: 200, epoch: 8 | loss: 0.7194501
	speed: 0.2144s/iter; left time: 316.8471s
	iters: 300, epoch: 8 | loss: 0.6102757
	speed: 0.2191s/iter; left time: 301.9224s
	iters: 400, epoch: 8 | loss: 0.6363877
	speed: 0.2062s/iter; left time: 263.4704s
	iters: 500, epoch: 8 | loss: 0.5291088
	speed: 0.2210s/iter; left time: 260.3911s
Epoch: 8 cost time: 123.75032925605774
Epoch: 8, Steps: 559 | Train Loss: 0.6428673 Vali Loss: 0.6778655 Test Loss: 0.3328364
Validation loss decreased (0.688919 --> 0.677866).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6324099
	speed: 0.9152s/iter; left time: 932.6101s
	iters: 200, epoch: 9 | loss: 0.7143761
	speed: 0.2110s/iter; left time: 193.9094s
	iters: 300, epoch: 9 | loss: 0.5873976
	speed: 0.2119s/iter; left time: 173.5638s
	iters: 400, epoch: 9 | loss: 0.7274371
	speed: 0.2143s/iter; left time: 154.0617s
	iters: 500, epoch: 9 | loss: 0.5712180
	speed: 0.2229s/iter; left time: 137.9547s
Epoch: 9 cost time: 121.08207631111145
Epoch: 9, Steps: 559 | Train Loss: 0.6415927 Vali Loss: 0.6790189 Test Loss: 0.3328799
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6436576
	speed: 0.9071s/iter; left time: 417.2723s
	iters: 200, epoch: 10 | loss: 0.6270618
	speed: 0.2238s/iter; left time: 80.5694s
	iters: 300, epoch: 10 | loss: 0.6167713
	speed: 0.2128s/iter; left time: 55.3313s
	iters: 400, epoch: 10 | loss: 0.6694250
	speed: 0.2382s/iter; left time: 38.1057s
	iters: 500, epoch: 10 | loss: 0.6431379
	speed: 0.2197s/iter; left time: 13.1809s
Epoch: 10 cost time: 124.8139979839325
Epoch: 10, Steps: 559 | Train Loss: 0.6414540 Vali Loss: 0.6804739 Test Loss: 0.3341459
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3328368067741394, mae:0.3446122109889984
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_960     Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           960                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_960_PatchTST_custom_ftM_sl336_ll48_pl960_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35592
val 4311
test 9580
	iters: 100, epoch: 1 | loss: 6.2535434
	speed: 0.1379s/iter; left time: 752.8934s
	iters: 200, epoch: 1 | loss: 5.5064321
	speed: 0.2270s/iter; left time: 1217.1625s
	iters: 300, epoch: 1 | loss: 3.0562930
	speed: 0.2124s/iter; left time: 1117.2836s
	iters: 400, epoch: 1 | loss: 1.3233203
	speed: 0.2162s/iter; left time: 1115.7790s
	iters: 500, epoch: 1 | loss: 1.0188458
	speed: 0.2226s/iter; left time: 1126.6721s
Epoch: 1 cost time: 113.73141407966614
Epoch: 1, Steps: 556 | Train Loss: 4.2499758 Vali Loss: 1.9390689 Test Loss: 0.7416838
Validation loss decreased (inf --> 1.939069).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6956488
	speed: 0.9165s/iter; left time: 4495.4867s
	iters: 200, epoch: 2 | loss: 0.7135993
	speed: 0.2317s/iter; left time: 1113.2629s
	iters: 300, epoch: 2 | loss: 0.6077111
	speed: 0.2303s/iter; left time: 1083.3472s
	iters: 400, epoch: 2 | loss: 0.8058535
	speed: 0.2242s/iter; left time: 1032.2326s
	iters: 500, epoch: 2 | loss: 0.6828113
	speed: 0.2226s/iter; left time: 1002.9584s
Epoch: 2 cost time: 126.50485706329346
Epoch: 2, Steps: 556 | Train Loss: 0.7159937 Vali Loss: 0.8087282 Test Loss: 0.3925016
Validation loss decreased (1.939069 --> 0.808728).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5563800
	speed: 0.8730s/iter; left time: 3796.7850s
	iters: 200, epoch: 3 | loss: 0.6121218
	speed: 0.2175s/iter; left time: 924.3029s
	iters: 300, epoch: 3 | loss: 0.6010552
	speed: 0.2232s/iter; left time: 926.1524s
	iters: 400, epoch: 3 | loss: 0.5515847
	speed: 0.2336s/iter; left time: 945.6644s
	iters: 500, epoch: 3 | loss: 0.6998575
	speed: 0.2203s/iter; left time: 869.8927s
Epoch: 3 cost time: 125.04072523117065
Epoch: 3, Steps: 556 | Train Loss: 0.6759077 Vali Loss: 0.8335478 Test Loss: 0.4003868
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6248215
	speed: 0.9084s/iter; left time: 3445.5882s
	iters: 200, epoch: 4 | loss: 0.6414812
	speed: 0.2222s/iter; left time: 820.7558s
	iters: 300, epoch: 4 | loss: 0.6902523
	speed: 0.2189s/iter; left time: 786.4005s
	iters: 400, epoch: 4 | loss: 0.7001483
	speed: 0.2222s/iter; left time: 776.0123s
	iters: 500, epoch: 4 | loss: 0.6342711
	speed: 0.2186s/iter; left time: 741.7132s
Epoch: 4 cost time: 123.1104724407196
Epoch: 4, Steps: 556 | Train Loss: 0.6675654 Vali Loss: 0.7299277 Test Loss: 0.3625825
Validation loss decreased (0.808728 --> 0.729928).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7670965
	speed: 0.8799s/iter; left time: 2848.0801s
	iters: 200, epoch: 5 | loss: 0.7128024
	speed: 0.2358s/iter; left time: 739.7495s
	iters: 300, epoch: 5 | loss: 0.6288088
	speed: 0.2234s/iter; left time: 678.3312s
	iters: 400, epoch: 5 | loss: 0.5243468
	speed: 0.2220s/iter; left time: 652.0869s
	iters: 500, epoch: 5 | loss: 0.7908527
	speed: 0.2332s/iter; left time: 661.5867s
Epoch: 5 cost time: 127.28391122817993
Epoch: 5, Steps: 556 | Train Loss: 0.6638082 Vali Loss: 0.7035238 Test Loss: 0.3557009
Validation loss decreased (0.729928 --> 0.703524).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6653438
	speed: 0.9018s/iter; left time: 2417.7186s
	iters: 200, epoch: 6 | loss: 0.7293977
	speed: 0.2391s/iter; left time: 617.1461s
	iters: 300, epoch: 6 | loss: 0.5814929
	speed: 0.2222s/iter; left time: 551.2097s
	iters: 400, epoch: 6 | loss: 0.7794369
	speed: 0.2339s/iter; left time: 556.8168s
	iters: 500, epoch: 6 | loss: 0.6519723
	speed: 0.2314s/iter; left time: 527.7157s
Epoch: 6 cost time: 127.95748162269592
Epoch: 6, Steps: 556 | Train Loss: 0.6614825 Vali Loss: 0.6967212 Test Loss: 0.3535461
Validation loss decreased (0.703524 --> 0.696721).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5830501
	speed: 0.9347s/iter; left time: 1986.3306s
	iters: 200, epoch: 7 | loss: 0.6576039
	speed: 0.2253s/iter; left time: 456.2114s
	iters: 300, epoch: 7 | loss: 0.5877300
	speed: 0.2310s/iter; left time: 444.6924s
	iters: 400, epoch: 7 | loss: 0.7524801
	speed: 0.2231s/iter; left time: 407.2089s
	iters: 500, epoch: 7 | loss: 0.5882258
	speed: 0.2277s/iter; left time: 392.8508s
Epoch: 7 cost time: 126.46509122848511
Epoch: 7, Steps: 556 | Train Loss: 0.6602492 Vali Loss: 0.6910757 Test Loss: 0.3519949
Validation loss decreased (0.696721 --> 0.691076).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6560131
	speed: 0.8406s/iter; left time: 1318.8891s
	iters: 200, epoch: 8 | loss: 0.6710770
	speed: 0.2202s/iter; left time: 323.4049s
	iters: 300, epoch: 8 | loss: 0.5711146
	speed: 0.2338s/iter; left time: 320.0072s
	iters: 400, epoch: 8 | loss: 0.5814131
	speed: 0.2651s/iter; left time: 336.3600s
	iters: 500, epoch: 8 | loss: 0.7256117
	speed: 0.2933s/iter; left time: 342.8135s
Epoch: 8 cost time: 139.338805437088
Epoch: 8, Steps: 556 | Train Loss: 0.6594312 Vali Loss: 0.6892324 Test Loss: 0.3516312
Validation loss decreased (0.691076 --> 0.689232).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6131156
	speed: 0.7933s/iter; left time: 803.6031s
	iters: 200, epoch: 9 | loss: 0.6784140
	speed: 0.2317s/iter; left time: 211.5215s
	iters: 300, epoch: 9 | loss: 0.5776554
	speed: 0.2470s/iter; left time: 200.8339s
	iters: 400, epoch: 9 | loss: 0.6432344
	speed: 0.2252s/iter; left time: 160.5395s
	iters: 500, epoch: 9 | loss: 0.6766956
	speed: 0.2430s/iter; left time: 148.9787s
Epoch: 9 cost time: 134.90551471710205
Epoch: 9, Steps: 556 | Train Loss: 0.6588555 Vali Loss: 0.6885291 Test Loss: 0.3511807
Validation loss decreased (0.689232 --> 0.688529).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7873351
	speed: 1.1616s/iter; left time: 530.8424s
	iters: 200, epoch: 10 | loss: 0.6540253
	speed: 0.2575s/iter; left time: 91.9365s
	iters: 300, epoch: 10 | loss: 0.5755496
	speed: 0.2558s/iter; left time: 65.7368s
	iters: 400, epoch: 10 | loss: 0.6485678
	speed: 0.2533s/iter; left time: 39.7757s
	iters: 500, epoch: 10 | loss: 0.7751907
	speed: 0.2390s/iter; left time: 13.6231s
Epoch: 10 cost time: 140.997132062912
Epoch: 10, Steps: 556 | Train Loss: 0.6585490 Vali Loss: 0.6885799 Test Loss: 0.3511185
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_960_PatchTST_custom_ftM_sl336_ll48_pl960_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9580
test shape: (9580, 960, 21) (9580, 960, 21)
test shape: (9580, 960, 21) (9580, 960, 21)
mse:0.3511817753314972, mae:0.3566893935203552
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1024    Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1024                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_1024_PatchTST_custom_ftM_sl336_ll48_pl1024_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35528
val 4247
test 9516
	iters: 100, epoch: 1 | loss: 4.4001284
	speed: 0.2339s/iter; left time: 1275.2269s
	iters: 200, epoch: 1 | loss: 5.7488823
	speed: 0.1518s/iter; left time: 812.2141s
	iters: 300, epoch: 1 | loss: 3.2219653
	speed: 0.2133s/iter; left time: 1120.2921s
	iters: 400, epoch: 1 | loss: 1.3180609
	speed: 0.2360s/iter; left time: 1215.6200s
	iters: 500, epoch: 1 | loss: 0.9061806
	speed: 0.2298s/iter; left time: 1160.4838s
Epoch: 1 cost time: 118.64616560935974
Epoch: 1, Steps: 555 | Train Loss: 4.0099833 Vali Loss: 1.2759746 Test Loss: 0.5352855
Validation loss decreased (inf --> 1.275975).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7990026
	speed: 1.0026s/iter; left time: 4908.5982s
	iters: 200, epoch: 2 | loss: 0.8060642
	speed: 0.2232s/iter; left time: 1070.4897s
	iters: 300, epoch: 2 | loss: 0.7518213
	speed: 0.2162s/iter; left time: 1015.1430s
	iters: 400, epoch: 2 | loss: 0.7507453
	speed: 0.2347s/iter; left time: 1078.6267s
	iters: 500, epoch: 2 | loss: 0.7847974
	speed: 0.2265s/iter; left time: 1018.5212s
Epoch: 2 cost time: 126.9974057674408
Epoch: 2, Steps: 555 | Train Loss: 0.8328397 Vali Loss: 1.0847401 Test Loss: 0.4738911
Validation loss decreased (1.275975 --> 1.084740).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6545469
	speed: 0.9594s/iter; left time: 4164.6982s
	iters: 200, epoch: 3 | loss: 0.7028775
	speed: 0.2230s/iter; left time: 945.8588s
	iters: 300, epoch: 3 | loss: 0.7021474
	speed: 0.2445s/iter; left time: 1012.3001s
	iters: 400, epoch: 3 | loss: 0.7401803
	speed: 0.2382s/iter; left time: 962.7009s
	iters: 500, epoch: 3 | loss: 0.6717651
	speed: 0.2345s/iter; left time: 924.1743s
Epoch: 3 cost time: 129.56902170181274
Epoch: 3, Steps: 555 | Train Loss: 0.7167950 Vali Loss: 0.7349988 Test Loss: 0.3708201
Validation loss decreased (1.084740 --> 0.734999).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.8629456
	speed: 0.9173s/iter; left time: 3472.8802s
	iters: 200, epoch: 4 | loss: 0.5974842
	speed: 0.2311s/iter; left time: 851.9537s
	iters: 300, epoch: 4 | loss: 0.6416511
	speed: 0.2421s/iter; left time: 868.1881s
	iters: 400, epoch: 4 | loss: 0.6980305
	speed: 0.2242s/iter; left time: 781.6745s
	iters: 500, epoch: 4 | loss: 0.6336934
	speed: 0.2390s/iter; left time: 809.1053s
Epoch: 4 cost time: 128.1200089454651
Epoch: 4, Steps: 555 | Train Loss: 0.6934417 Vali Loss: 0.7152088 Test Loss: 0.3652627
Validation loss decreased (0.734999 --> 0.715209).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7350039
	speed: 0.8827s/iter; left time: 2851.9517s
	iters: 200, epoch: 5 | loss: 0.7243646
	speed: 0.2271s/iter; left time: 711.2049s
	iters: 300, epoch: 5 | loss: 0.7566851
	speed: 0.2252s/iter; left time: 682.4466s
	iters: 400, epoch: 5 | loss: 0.6409671
	speed: 0.2307s/iter; left time: 676.1449s
	iters: 500, epoch: 5 | loss: 0.6422148
	speed: 0.2386s/iter; left time: 675.6040s
Epoch: 5 cost time: 127.9713659286499
Epoch: 5, Steps: 555 | Train Loss: 0.6835131 Vali Loss: 0.7027200 Test Loss: 0.3591839
Validation loss decreased (0.715209 --> 0.702720).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6688499
	speed: 0.9336s/iter; left time: 2498.2977s
	iters: 200, epoch: 6 | loss: 0.5808122
	speed: 0.2329s/iter; left time: 600.0562s
	iters: 300, epoch: 6 | loss: 0.6742555
	speed: 0.2440s/iter; left time: 604.1210s
	iters: 400, epoch: 6 | loss: 0.6389980
	speed: 0.2239s/iter; left time: 532.0008s
	iters: 500, epoch: 6 | loss: 0.7468858
	speed: 0.2506s/iter; left time: 570.2878s
Epoch: 6 cost time: 132.48855352401733
Epoch: 6, Steps: 555 | Train Loss: 0.6778911 Vali Loss: 0.6965908 Test Loss: 0.3582120
Validation loss decreased (0.702720 --> 0.696591).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5850981
	speed: 0.9638s/iter; left time: 2044.1845s
	iters: 200, epoch: 7 | loss: 0.6293184
	speed: 0.2275s/iter; left time: 459.7637s
	iters: 300, epoch: 7 | loss: 0.7185003
	speed: 0.2402s/iter; left time: 461.4029s
	iters: 400, epoch: 7 | loss: 0.6342634
	speed: 0.2352s/iter; left time: 428.3594s
	iters: 500, epoch: 7 | loss: 0.5456251
	speed: 0.2175s/iter; left time: 374.2905s
Epoch: 7 cost time: 128.44378232955933
Epoch: 7, Steps: 555 | Train Loss: 0.6746427 Vali Loss: 0.6939182 Test Loss: 0.3568696
Validation loss decreased (0.696591 --> 0.693918).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.7732948
	speed: 1.0070s/iter; left time: 1577.0008s
	iters: 200, epoch: 8 | loss: 0.6641697
	speed: 0.2383s/iter; left time: 349.3169s
	iters: 300, epoch: 8 | loss: 0.7201346
	speed: 0.2365s/iter; left time: 323.0709s
	iters: 400, epoch: 8 | loss: 0.5863058
	speed: 0.2284s/iter; left time: 289.0932s
	iters: 500, epoch: 8 | loss: 0.5407757
	speed: 0.2269s/iter; left time: 264.6150s
Epoch: 8 cost time: 128.64445281028748
Epoch: 8, Steps: 555 | Train Loss: 0.6727553 Vali Loss: 0.6927067 Test Loss: 0.3574962
Validation loss decreased (0.693918 --> 0.692707).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6933559
	speed: 0.8695s/iter; left time: 879.0182s
	iters: 200, epoch: 9 | loss: 0.7064354
	speed: 0.2141s/iter; left time: 195.0091s
	iters: 300, epoch: 9 | loss: 0.5904449
	speed: 0.2246s/iter; left time: 182.1899s
	iters: 400, epoch: 9 | loss: 0.6055419
	speed: 0.2254s/iter; left time: 160.2690s
	iters: 500, epoch: 9 | loss: 0.6921992
	speed: 0.2407s/iter; left time: 147.0778s
Epoch: 9 cost time: 128.3699448108673
Epoch: 9, Steps: 555 | Train Loss: 0.6715735 Vali Loss: 0.6921958 Test Loss: 0.3567754
Validation loss decreased (0.692707 --> 0.692196).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7544287
	speed: 0.9938s/iter; left time: 453.1628s
	iters: 200, epoch: 10 | loss: 0.5738977
	speed: 0.2266s/iter; left time: 80.6577s
	iters: 300, epoch: 10 | loss: 0.6935027
	speed: 0.2341s/iter; left time: 59.9392s
	iters: 400, epoch: 10 | loss: 0.7042809
	speed: 0.2388s/iter; left time: 37.2556s
	iters: 500, epoch: 10 | loss: 0.6572667
	speed: 0.2279s/iter; left time: 12.7638s
Epoch: 10 cost time: 129.29110646247864
Epoch: 10, Steps: 555 | Train Loss: 0.6707416 Vali Loss: 0.6905023 Test Loss: 0.3563063
Validation loss decreased (0.692196 --> 0.690502).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_1024_PatchTST_custom_ftM_sl336_ll48_pl1024_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9516
test shape: (9516, 1024, 21) (9516, 1024, 21)
test shape: (9516, 1024, 21) (9516, 1024, 21)
mse:0.3563072979450226, mae:0.36066585779190063
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1240    Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1240                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_1240_PatchTST_custom_ftM_sl336_ll48_pl1240_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35312
val 4031
test 9300
	iters: 100, epoch: 1 | loss: 3.4899826
	speed: 0.1282s/iter; left time: 693.6760s
	iters: 200, epoch: 1 | loss: 3.7897537
	speed: 0.2128s/iter; left time: 1130.3484s
	iters: 300, epoch: 1 | loss: 2.9217417
	speed: 0.2431s/iter; left time: 1266.9249s
	iters: 400, epoch: 1 | loss: 1.5712161
	speed: 0.2427s/iter; left time: 1240.5777s
	iters: 500, epoch: 1 | loss: 1.1456312
	speed: 0.2563s/iter; left time: 1284.3676s
Epoch: 1 cost time: 120.45442748069763
Epoch: 1, Steps: 551 | Train Loss: 3.2128360 Vali Loss: 1.4809635 Test Loss: 0.6141512
Validation loss decreased (inf --> 1.480964).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 58.4675064
	speed: 0.9854s/iter; left time: 4788.9034s
	iters: 200, epoch: 2 | loss: 2.1246643
	speed: 0.2362s/iter; left time: 1124.2975s
	iters: 300, epoch: 2 | loss: 1.3534747
	speed: 0.2286s/iter; left time: 1065.3479s
	iters: 400, epoch: 2 | loss: 1.2174239
	speed: 0.2526s/iter; left time: 1151.8800s
	iters: 500, epoch: 2 | loss: 0.9587957
	speed: 0.2176s/iter; left time: 970.3858s
Epoch: 2 cost time: 127.05146336555481
Epoch: 2, Steps: 551 | Train Loss: 2.8224235 Vali Loss: 0.9271090 Test Loss: 0.4383559
Validation loss decreased (1.480964 --> 0.927109).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.8234161
	speed: 1.0303s/iter; left time: 4439.6044s
	iters: 200, epoch: 3 | loss: 1.0050920
	speed: 0.2433s/iter; left time: 1024.1449s
	iters: 300, epoch: 3 | loss: 1.1049914
	speed: 0.2393s/iter; left time: 983.1071s
	iters: 400, epoch: 3 | loss: 0.7665558
	speed: 0.2365s/iter; left time: 948.1460s
	iters: 500, epoch: 3 | loss: 0.8090016
	speed: 0.2266s/iter; left time: 885.6075s
Epoch: 3 cost time: 131.3536081314087
Epoch: 3, Steps: 551 | Train Loss: 0.8698747 Vali Loss: 0.7735221 Test Loss: 0.3931148
Validation loss decreased (0.927109 --> 0.773522).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7783296
	speed: 0.9114s/iter; left time: 3424.9307s
	iters: 200, epoch: 4 | loss: 0.6927724
	speed: 0.2537s/iter; left time: 928.1292s
	iters: 300, epoch: 4 | loss: 0.8508083
	speed: 0.2384s/iter; left time: 848.3175s
	iters: 400, epoch: 4 | loss: 0.7670834
	speed: 0.2381s/iter; left time: 823.3953s
	iters: 500, epoch: 4 | loss: 0.8688313
	speed: 0.2321s/iter; left time: 779.3897s
Epoch: 4 cost time: 133.41329145431519
Epoch: 4, Steps: 551 | Train Loss: 0.7946421 Vali Loss: 0.7378061 Test Loss: 0.3795924
Validation loss decreased (0.773522 --> 0.737806).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7884608
	speed: 1.0384s/iter; left time: 3330.1686s
	iters: 200, epoch: 5 | loss: 0.8149939
	speed: 0.2293s/iter; left time: 712.5703s
	iters: 300, epoch: 5 | loss: 0.7394224
	speed: 0.2504s/iter; left time: 752.8859s
	iters: 400, epoch: 5 | loss: 0.7673023
	speed: 0.2400s/iter; left time: 697.8083s
	iters: 500, epoch: 5 | loss: 0.7418645
	speed: 0.2436s/iter; left time: 683.9072s
Epoch: 5 cost time: 130.2029504776001
Epoch: 5, Steps: 551 | Train Loss: 0.7677750 Vali Loss: 0.7323875 Test Loss: 0.3776009
Validation loss decreased (0.737806 --> 0.732387).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7411503
	speed: 0.8251s/iter; left time: 2191.5524s
	iters: 200, epoch: 6 | loss: 0.7512704
	speed: 0.1888s/iter; left time: 482.5930s
	iters: 300, epoch: 6 | loss: 0.7746087
	speed: 0.2061s/iter; left time: 506.1461s
	iters: 400, epoch: 6 | loss: 0.7828731
	speed: 0.1945s/iter; left time: 458.2592s
	iters: 500, epoch: 6 | loss: 0.7871572
	speed: 0.1941s/iter; left time: 437.8953s
Epoch: 6 cost time: 111.13472580909729
Epoch: 6, Steps: 551 | Train Loss: 0.7546005 Vali Loss: 0.7235394 Test Loss: 0.3746636
Validation loss decreased (0.732387 --> 0.723539).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.8076970
	speed: 0.8164s/iter; left time: 1718.5234s
	iters: 200, epoch: 7 | loss: 0.7433128
	speed: 0.2054s/iter; left time: 411.8812s
	iters: 300, epoch: 7 | loss: 0.8281187
	speed: 0.1995s/iter; left time: 380.1415s
	iters: 400, epoch: 7 | loss: 0.7002604
	speed: 0.2097s/iter; left time: 378.5830s
	iters: 500, epoch: 7 | loss: 0.7550832
	speed: 0.2128s/iter; left time: 362.7598s
Epoch: 7 cost time: 113.42474865913391
Epoch: 7, Steps: 551 | Train Loss: 0.7466860 Vali Loss: 0.7198413 Test Loss: 0.3738363
Validation loss decreased (0.723539 --> 0.719841).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.7932687
	speed: 0.8581s/iter; left time: 1333.4877s
	iters: 200, epoch: 8 | loss: 0.7099540
	speed: 0.2113s/iter; left time: 307.2743s
	iters: 300, epoch: 8 | loss: 0.7069195
	speed: 0.2034s/iter; left time: 275.4490s
	iters: 400, epoch: 8 | loss: 0.6860953
	speed: 0.2048s/iter; left time: 256.8017s
	iters: 500, epoch: 8 | loss: 0.8086774
	speed: 0.1978s/iter; left time: 228.2954s
Epoch: 8 cost time: 113.57910680770874
Epoch: 8, Steps: 551 | Train Loss: 0.7424837 Vali Loss: 0.7207881 Test Loss: 0.3737730
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.8167480
	speed: 0.8117s/iter; left time: 814.1080s
	iters: 200, epoch: 9 | loss: 0.7097754
	speed: 0.2098s/iter; left time: 189.4763s
	iters: 300, epoch: 9 | loss: 0.6836219
	speed: 0.2134s/iter; left time: 171.3427s
	iters: 400, epoch: 9 | loss: 0.7030225
	speed: 0.2046s/iter; left time: 143.8315s
	iters: 500, epoch: 9 | loss: 0.7778506
	speed: 0.1967s/iter; left time: 118.6032s
Epoch: 9 cost time: 113.14871048927307
Epoch: 9, Steps: 551 | Train Loss: 0.7398765 Vali Loss: 0.7194934 Test Loss: 0.3736186
Validation loss decreased (0.719841 --> 0.719493).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7943575
	speed: 0.8200s/iter; left time: 370.6492s
	iters: 200, epoch: 10 | loss: 0.7552370
	speed: 0.1919s/iter; left time: 67.5350s
	iters: 300, epoch: 10 | loss: 0.7343273
	speed: 0.1700s/iter; left time: 42.8398s
	iters: 400, epoch: 10 | loss: 0.7630293
	speed: 0.1684s/iter; left time: 25.6001s
	iters: 500, epoch: 10 | loss: 0.7920343
	speed: 0.1826s/iter; left time: 9.4977s
Epoch: 10 cost time: 103.06188678741455
Epoch: 10, Steps: 551 | Train Loss: 0.7381803 Vali Loss: 0.7182590 Test Loss: 0.3735485
Validation loss decreased (0.719493 --> 0.718259).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_1240_PatchTST_custom_ftM_sl336_ll48_pl1240_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9300
test shape: (9300, 1240, 21) (9300, 1240, 21)
test shape: (9300, 1240, 21) (9300, 1240, 21)
mse:0.3735489547252655, mae:0.37006253004074097
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_1688    Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          /home/home_new/qsmx/pycodes/BasicTS/datasets/raw_data/Weather/
  Data Path:          Weather.csv         Features:           M                   
  Target:             OT                  Freq:               w                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           1688                Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.005               
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:1
>>>>>>>start training : long_term_forecast_weather_336_1688_PatchTST_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34864
val 3583
test 8852
	iters: 100, epoch: 1 | loss: 4.5709805
	speed: 0.1908s/iter; left time: 1019.0713s
	iters: 200, epoch: 1 | loss: 6.6126304
	speed: 0.1471s/iter; left time: 770.9083s
	iters: 300, epoch: 1 | loss: 3.0980365
	speed: 0.1954s/iter; left time: 1004.5311s
	iters: 400, epoch: 1 | loss: 1.8720158
	speed: 0.1921s/iter; left time: 968.3941s
	iters: 500, epoch: 1 | loss: 1.2256533
	speed: 0.2043s/iter; left time: 1009.3948s
Epoch: 1 cost time: 102.95266723632812
Epoch: 1, Steps: 544 | Train Loss: 4.3720543 Vali Loss: 3.6995282 Test Loss: 1.2006831
Validation loss decreased (inf --> 3.699528).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.8203790
	speed: 0.7999s/iter; left time: 3837.0787s
	iters: 200, epoch: 2 | loss: 0.9250037
	speed: 0.2151s/iter; left time: 1010.2233s
	iters: 300, epoch: 2 | loss: 0.7165149
	speed: 0.2351s/iter; left time: 1080.9566s
	iters: 400, epoch: 2 | loss: 0.8220765
	speed: 0.2167s/iter; left time: 974.5944s
	iters: 500, epoch: 2 | loss: 0.7318049
	speed: 0.2049s/iter; left time: 900.7718s
Epoch: 2 cost time: 117.67224645614624
Epoch: 2, Steps: 544 | Train Loss: 0.8171608 Vali Loss: 1.0860661 Test Loss: 0.4846588
Validation loss decreased (3.699528 --> 1.086066).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7908353
	speed: 0.8173s/iter; left time: 3476.0656s
	iters: 200, epoch: 3 | loss: 0.7325242
	speed: 0.2107s/iter; left time: 875.1669s
	iters: 300, epoch: 3 | loss: 0.7442809
	speed: 0.2132s/iter; left time: 863.9230s
	iters: 400, epoch: 3 | loss: 0.6636327
	speed: 0.2181s/iter; left time: 862.2340s
	iters: 500, epoch: 3 | loss: 0.6668007
	speed: 0.2091s/iter; left time: 805.7072s
Epoch: 3 cost time: 117.09391498565674
Epoch: 3, Steps: 544 | Train Loss: 0.7202137 Vali Loss: 0.8447807 Test Loss: 0.4141403
Validation loss decreased (1.086066 --> 0.844781).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7908514
	speed: 0.7744s/iter; left time: 2872.2913s
	iters: 200, epoch: 4 | loss: 0.6250652
	speed: 0.2143s/iter; left time: 773.4853s
	iters: 300, epoch: 4 | loss: 0.8405640
	speed: 0.1990s/iter; left time: 698.3083s
	iters: 400, epoch: 4 | loss: 0.8066070
	speed: 0.2223s/iter; left time: 757.9489s
	iters: 500, epoch: 4 | loss: 0.6416030
	speed: 0.2041s/iter; left time: 675.4639s
Epoch: 4 cost time: 114.01632595062256
Epoch: 4, Steps: 544 | Train Loss: 0.7114071 Vali Loss: 0.8020874 Test Loss: 0.4029862
Validation loss decreased (0.844781 --> 0.802087).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6719478
	speed: 0.8546s/iter; left time: 2704.8550s
	iters: 200, epoch: 5 | loss: 0.7200946
	speed: 0.2112s/iter; left time: 647.4306s
	iters: 300, epoch: 5 | loss: 0.6835214
	speed: 0.2111s/iter; left time: 625.8515s
	iters: 400, epoch: 5 | loss: 0.7170467
	speed: 0.2091s/iter; left time: 599.0379s
	iters: 500, epoch: 5 | loss: 0.8434793
	speed: 0.2262s/iter; left time: 625.4534s
Epoch: 5 cost time: 116.53650856018066
Epoch: 5, Steps: 544 | Train Loss: 0.7089209 Vali Loss: 0.7983893 Test Loss: 0.4006191
Validation loss decreased (0.802087 --> 0.798389).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6645195
	speed: 0.8270s/iter; left time: 2167.5260s
	iters: 200, epoch: 6 | loss: 0.8175994
	speed: 0.2116s/iter; left time: 533.3947s
	iters: 300, epoch: 6 | loss: 0.7069862
	speed: 0.2422s/iter; left time: 586.3873s
	iters: 400, epoch: 6 | loss: 0.7073579
	speed: 0.2474s/iter; left time: 574.2479s
	iters: 500, epoch: 6 | loss: 0.6892359
	speed: 0.2423s/iter; left time: 538.0646s
Epoch: 6 cost time: 126.5706238746643
Epoch: 6, Steps: 544 | Train Loss: 0.7067813 Vali Loss: 0.7847679 Test Loss: 0.3970850
Validation loss decreased (0.798389 --> 0.784768).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.6855766
	speed: 0.8976s/iter; left time: 1864.3154s
	iters: 200, epoch: 7 | loss: 0.6254016
	speed: 0.2223s/iter; left time: 439.4453s
	iters: 300, epoch: 7 | loss: 0.7712094
	speed: 0.2163s/iter; left time: 405.9218s
	iters: 400, epoch: 7 | loss: 0.6496961
	speed: 0.2224s/iter; left time: 395.1731s
	iters: 500, epoch: 7 | loss: 0.7004542
	speed: 0.2156s/iter; left time: 361.6045s
Epoch: 7 cost time: 118.36672186851501
Epoch: 7, Steps: 544 | Train Loss: 0.7058967 Vali Loss: 0.7797775 Test Loss: 0.3961903
Validation loss decreased (0.784768 --> 0.779778).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6745649
	speed: 0.7959s/iter; left time: 1220.0506s
	iters: 200, epoch: 8 | loss: 0.6310351
	speed: 0.2006s/iter; left time: 287.4494s
	iters: 300, epoch: 8 | loss: 0.6815637
	speed: 0.2118s/iter; left time: 282.2904s
	iters: 400, epoch: 8 | loss: 0.6527810
	speed: 0.2192s/iter; left time: 270.2500s
	iters: 500, epoch: 8 | loss: 0.6559205
	speed: 0.2195s/iter; left time: 248.6392s
Epoch: 8 cost time: 115.38750982284546
Epoch: 8, Steps: 544 | Train Loss: 0.7055286 Vali Loss: 0.7795368 Test Loss: 0.3958982
Validation loss decreased (0.779778 --> 0.779537).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6842603
	speed: 0.7799s/iter; left time: 771.3616s
	iters: 200, epoch: 9 | loss: 0.6966479
	speed: 0.2517s/iter; left time: 223.7263s
	iters: 300, epoch: 9 | loss: 0.6360112
	speed: 0.2484s/iter; left time: 195.9748s
	iters: 400, epoch: 9 | loss: 0.6848788
	speed: 0.2582s/iter; left time: 177.8719s
	iters: 500, epoch: 9 | loss: 0.6374357
	speed: 0.2499s/iter; left time: 147.2095s
Epoch: 9 cost time: 133.58176016807556
Epoch: 9, Steps: 544 | Train Loss: 0.7050549 Vali Loss: 0.7798216 Test Loss: 0.3958663
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6190894
	speed: 0.8658s/iter; left time: 385.3006s
	iters: 200, epoch: 10 | loss: 0.7124553
	speed: 0.2320s/iter; left time: 80.0481s
	iters: 300, epoch: 10 | loss: 0.7285529
	speed: 0.2256s/iter; left time: 55.2598s
	iters: 400, epoch: 10 | loss: 0.7098595
	speed: 0.2156s/iter; left time: 31.2574s
	iters: 500, epoch: 10 | loss: 0.8138234
	speed: 0.2212s/iter; left time: 9.9547s
Epoch: 10 cost time: 120.28622198104858
Epoch: 10, Steps: 544 | Train Loss: 0.7046720 Vali Loss: 0.7791520 Test Loss: 0.3956815
Validation loss decreased (0.779537 --> 0.779152).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_weather_336_1688_PatchTST_custom_ftM_sl336_ll48_pl1688_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8852
test shape: (8852, 1688, 21) (8852, 1688, 21)
test shape: (8852, 1688, 21) (8852, 1688, 21)
mse:0.3956800103187561, mae:0.38431382179260254
